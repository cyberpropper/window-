<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º—è–≥–∫–∏—Ö –æ–∫–æ–Ω</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg-main: #e9f2fb;
      --bg-card: #ffffff;
      --blue: #2c7ef4;
      --blue-soft: #dbeafe;
      --border-soft: #d0d8e8;
      --text-main: #1f2937;
      --text-muted: #64748b;
      --text-soft: #94a3b8;
      --frame: #2a2f38;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-main);
      color: var(--text-main);
    }

    /* ============ –≠–ö–†–ê–ù –õ–û–ì–ò–ù–ê ============ */
    #login-screen {
      position: fixed;
      inset: 0;
      background: #e2e8f0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }

    #login-box {
      background: #fff;
      padding: 22px 24px 20px;
      border-radius: 14px;
      box-shadow: 0 18px 40px rgba(15,23,42,.18);
      width: 300px;
    }

    #login-box h1 {
      font-size: 18px;
      margin: 0 0 6px;
    }

    #login-box p {
      font-size: 12px;
      margin: 0 0 14px;
      color: var(--text-muted);
    }

    #login-box input {
      width: 100%;
      margin-bottom: 10px;
      padding: 7px 9px;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
      font-size: 13px;
    }

    #login-box button {
      width: 100%;
      background: var(--blue);
      border: none;
      color: #fff;
      padding: 8px 0;
      border-radius: 8px;
      font-weight: 500;
      font-size: 13px;
      cursor: pointer;
    }

    #login-error {
      color: #ef4444;
      font-size: 12px;
      min-height: 18px;
      margin-bottom: 4px;
    }

    /* ============ –û–°–ù–û–í–ù–û–ô –ö–ê–†–ö–ê–° SOFTGLASS ============ */

    #app {
      display: none;
    }

    .soft-shell {
      max-width: 1360px;
      margin: 10px auto 20px;
      padding: 0 12px 20px;
    }

    /* –í–µ—Ä—Ö–Ω—è—è –≥–æ–ª—É–±–∞—è –ø–∞–Ω–µ–ª—å */
    .soft-topbar {
      height: 52px;
      background: #f5f9ff;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.05);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      margin-bottom: 10px;
    }

    .soft-topbar__left {
      display: flex;
      align-items: center;
      gap: 16px;
      font-size: 13px;
    }

    .soft-topbar__menu {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .soft-topbar__menu-btn {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid transparent;
      background: transparent;
      font-size: 12px;
      color: var(--text-muted);
      cursor: pointer;
    }

    .soft-topbar__menu-btn--primary {
      background: #e0efff;
      color: var(--blue);
      border-color: #bfdbfe;
      font-weight: 500;
    }

    .soft-topbar__right {
      display: flex;
      align-items: center;
      gap: 16px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .soft-topbar__cart {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .soft-topbar__cart-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid #bfdbfe;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      color: var(--blue);
      background: #e0efff;
    }

    .soft-topbar__user {
      font-weight: 500;
      color: var(--text-main);
    }

    /* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å: —Å–ª–µ–≤–∞ –º–µ–Ω—é, —Å–ø—Ä–∞–≤–∞ —Ä–∞–±–æ—á–∞—è –∑–æ–Ω–∞ */
    .soft-main {
      display: grid;
      grid-template-columns: 86px minmax(0, 1fr);
      gap: 10px;
      margin-top: 6px;
    }

    /* –õ–ï–í–û–ï –í–ï–†–¢–ò–ö–ê–õ–¨–ù–û–ï –ú–ï–ù–Æ */
    .soft-sidebar {
      background: var(--bg-card);
      border-radius: 12px;
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
      padding: 10px 0 14px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .soft-sidebar__title {
      font-size: 11px;
      color: var(--text-soft);
      text-align: center;
      padding: 0 6px 6px;
      border-bottom: 1px solid #e5e7eb;
      margin-bottom: 2px;
    }

    .soft-sidebar__items {
      display: flex;
      flex-direction: column;
      gap: 8px;
      width: 100%;
      padding: 0 8px;
    }

    .soft-sidebar__item {
      width: 100%;
      height: 40px;
      border-radius: 10px;
      background: #f3f4f6;
      border: 1px solid transparent;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 0 8px;
      gap: 8px;
      cursor: pointer;
      font-size: 11px;
      color: var(--text-muted);
      transition: 0.12s ease;
    }

    .soft-sidebar__item-icon {
      width: 18px;
      height: 18px;
      border-radius: 4px;
      background: #e5e7eb;
    }

    .soft-sidebar__item--active {
      background: #e0efff;
      border-color: #bfdbfe;
      color: var(--blue);
    }

    /* –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨: —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ + —Å–ø—Ä–∞–≤–∞ –º–∞—Å—Ç–µ—Ä –≤–∫–ª–∞–¥–æ–∫ */
    .soft-work {
      background: var(--bg-card);
      border-radius: 14px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
      padding: 14px 16px 10px;
      display: grid;
      grid-template-columns: minmax(0, 2.2fr) minmax(320px, 1.2fr);
      gap: 12px;
    }

    /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å —Å –æ–∫–Ω–æ–º */
    .soft-center {
      display: flex;
      flex-direction: column;
      gap: 8px;
      border-right: 1px solid #e5e7eb;
      padding-right: 12px;
    }

    .soft-center__header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      font-size: 13px;
    }

    .soft-center__title {
      font-weight: 600;
    }

    .soft-center__counter {
      font-size: 11px;
      color: var(--text-soft);
    }

    .soft-drawing-wrapper {
      background: #f9fbff;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 14px 16px 16px;
    }

    .soft-drawing-top-scale,
    .soft-drawing-bottom-scale {
      text-align: center;
      font-size: 11px;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    .soft-drawing-main {
      border-radius: 10px;
      background: #ffffff;
      border: 1px solid #d7dce3;
      padding: 8px;
    }

    /* –õ–µ–≤–∞—è –ø–æ–¥–ø–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —Ü–µ–Ω—Ç—Ä–µ (—Ñ–æ—Ä–º–∞ + —Ä–∞–∑–º–µ—Ä—ã + –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏) */
    .soft-center__grid {
      display: grid;
      grid-template-columns: minmax(260px, 300px) minmax(0, 1fr);
      gap: 12px;
      margin-top: 8px;
    }

    .settings-card {
      background: #f9fbff;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 10px 12px 12px;
      font-size: 12px;
    }

    .settings-card h2 {
      margin: 0 0 4px;
      font-size: 14px;
    }

    .settings-card small {
      display: block;
      margin-bottom: 8px;
      font-size: 11px;
      color: var(--text-soft);
    }

    .settings-field {
      margin-bottom: 8px;
    }

    .settings-field label {
      display: block;
      font-size: 11px;
      margin-bottom: 2px;
    }

    .settings-field input,
    .settings-field select {
      width: 100%;
      font-size: 12px;
      padding: 5px 7px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
    }

    .settings-field-inline {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .settings-footer {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .btn-primary {
      background: var(--blue);
      border-radius: 8px;
      border: none;
      color: #fff;
      font-size: 12px;
      padding: 7px 14px;
      cursor: pointer;
    }

    .btn-ghost {
      background: #eef1f6;
      border-radius: 8px;
      border: none;
      color: #111827;
      font-size: 12px;
      padding: 7px 14px;
      cursor: pointer;
    }

    .result-card {
      position: relative;
      background: #ffffff;
      border-radius: 16px;
      border: 1px solid #e2e8f0;
      padding: 14px 16px 14px;
      font-size: 13px;
      line-height: 1.5;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.06);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .result-card strong {
      font-weight: 600;
    }

    .result-tabs {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px;
      border-radius: 999px;
      background: #f1f5f9;
      border: 1px solid #e2e8f0;
    }

    .result-tab {
      border-radius: 999px;
      border: none;
      background: transparent;
      padding: 5px 14px;
      font-size: 12px;
      cursor: pointer;
      color: #64748b;
      transition: 0.18s ease;
      font-weight: 500;
    }

    /* –ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ ‚Äî –±–µ–ª–∞—è ¬´—Ç–∞–±–ª–µ—Ç–∫–∞¬ª */
    .result-tab--active {
      background: #ffffff;
      color: #1d4ed8;
      box-shadow: 0 0 0 1px rgba(129, 140, 248, 0.35);
    }


    /* –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ–¥ –≤–∫–ª–∞–¥–∫–∞–º–∏ */
    .result-view {
      display: none;
      margin-top: 4px;
      padding-top: 4px;
    }

    /* –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é */
    .result-view--active {
      display: block;
    }

    /* –ø–æ–¥–ø–∏—Å—å ¬´–∏—Ç–æ–≥–æ –ø–æ –∑–∞–∫–∞–∑—É¬ª –≤–æ –≤–∫–ª–∞–¥–∫–µ –ó–∞–∫–∞–∑ */
    .order-tab-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px solid #e5e7eb;
      font-size: 13px;
      font-weight: 500;
    }

    /* –ü–†–ê–í–´–ô –ú–ê–°–¢–ï–† –í–ö–õ–ê–î–û–ö */
    .soft-right {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .soft-tabs {
      display: flex;
      gap: 6px;
      font-size: 11px;
      border-bottom: 1px solid #e5e7eb;
      padding-bottom: 6px;
      margin-bottom: 4px;
    }

    .soft-tab {
      padding: 5px 9px;
      border-radius: 7px 7px 0 0;
      border: 1px solid transparent;
      border-bottom: none;
      cursor: pointer;
      color: var(--text-soft);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .soft-tab span.icon {
      width: 12px;
      height: 12px;
      border-radius: 3px;
      background: #e5e7eb;
    }

    .soft-tab--active {
      background: #f9fbff;
      border-color: #d0d8e8;
      color: var(--blue);
      font-weight: 500;
    }

    .soft-tab-panels {
      background: #f9fbff;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 10px 12px 12px;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .soft-tab-panel {
      display: none;
      font-size: 12px;
    }

    .soft-tab-panel--active {
      display: block;
    }

    .shape-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 8px;
      margin-top: 8px;
    }

    .shape-card {
      height: 56px;
      border-radius: 9px;
      background: #f1f5f9;
      border: 1px solid transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.12s ease;
    }

    .shape-card svg {
      width: 70%;
      height: 70%;
    }

    .shape-card--active {
      border-color: #2563eb;
      background: #e0efff;
      box-shadow: 0 0 0 1px #bfdbfe;
    }

    .shape-card:hover {
      background: #e2e8f0;
    }

    .radio-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
      font-size: 11px;
    }

    .pill {
      border-radius: 999px;
      padding: 5px 10px;
      border: 1px solid #cbd5e1;
      cursor: pointer;
      background: #f1f5f9;
    }

    .pill--active {
      background: #e0efff;
      border-color: #2563eb;
      color: #1d4ed8;
    }

    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-top: 6px;
    }

    .toggle {
      width: 34px;
      height: 18px;
      border-radius: 999px;
      background: #e5e7eb;
      position: relative;
      cursor: pointer;
    }

    .toggle__thumb {
      position: absolute;
      top: 2px;
      left: 2px;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #9ca3af;
      transition: 0.12s ease;
    }

    .toggle--on {
      background: #4ade80;
    }

    .toggle--on .toggle__thumb {
      left: 18px;
      background: #ffffff;
    }

    .slider-row {
      margin-top: 8px;
      font-size: 11px;
    }

    .slider-pills {
      display: flex;
      gap: 6px;
      margin-top: 4px;
    }

    .summary-footer {
      margin-top: auto;
      padding-top: 6px;
      border-top: 1px solid #e5e7eb;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .summary-footer__price {
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .summary-footer__price-main {
      font-weight: 600;
      font-size: 14px;
      color: var(--blue);
    }

    .summary-footer__btns {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .btn-add {
      background: var(--blue);
      border-radius: 999px;
      border: none;
      color: #fff;
      font-size: 12px;
      padding: 7px 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .btn-add span.icon {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: rgba(255,255,255,0.25);
    }

    .btn-round {
      width: 30px;
      height: 30px;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      background: #f9fbff;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* –ù–∏–∂–Ω—è—è –ø–æ–ª–æ—Å–∫–∞ (–ø–ª–æ—â–∞–¥—å –∏ —Ç.–ø.) */
    .soft-bottom {
      margin-top: 8px;
      font-size: 11px;
      color: var(--text-soft);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .soft-bottom__left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .soft-bottom__badge {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(0,0,0,0.65);
      color: #f9fafb;
      font-size: 10px;
    }

    /* –°–∫—Ä—ã–≤–∞–µ–º —Å–µ–ª–µ–∫—Ç —Ñ–æ—Ä–º—ã ‚Äî –µ–≥–æ –¥—ë—Ä–≥–∞—é—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ */
    #shape {
      position: absolute;
      left: -9999px;
      opacity: 0;
      width: 1px;
      height: 1px;
      pointer-events: none;
    }

    @media (max-width: 1100px) {
      .soft-work {
        grid-template-columns: minmax(0, 1fr);
      }
      .soft-center {
        border-right: none;
        padding-right: 0;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 12px;
      }
    }

    @media (max-width: 900px) {
      .soft-main {
        grid-template-columns: minmax(0, 1fr);
      }
      .soft-sidebar {
        flex-direction: row;
        height: auto;
        justify-content: center;
      }
    }

    .order-panel {
      background:#fff;
      border:1px solid #e1e6ef;
      border-radius:12px;
      padding:12px 14px;
      box-shadow:0 6px 18px rgba(15,23,42,.04);
      max-width:1080px;
      margin:10px auto 20px; /* –±—ã–ª–æ 0 auto 20px */
      font-size:13px;
    }

    .order-panel__header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:8px;
    }

    .order-panel__title {
      font-weight:600;
    }

    .btn-primary-small {
      background:#1d7ff0;
      border:none;
      color:#fff;
      padding:5px 10px;
      border-radius:999px;
      font-size:12px;
      cursor:pointer;
    }

    .order-list {
      border-top:1px solid #e5e7eb;
      border-bottom:1px solid #e5e7eb;
      padding:6px 0;
      max-height:220px;
      overflow-y:auto;
    }

    .order-item {
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding:6px 0;
      border-bottom:1px dashed #e5e7eb;
    }
    .order-item:last-child {
      border-bottom:none;
    }

    .order-item__title {
      font-weight:500;
    }
    .order-item__meta {
      font-size:11px;
      color:#6b7280;
    }
    .order-item__extras {
      font-size:11px;
      color:#9ca3af;
    }

    .order-item__side {
      text-align:right;
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:4px;
    }

    .order-item__price {
      font-weight:600;
    }

    .order-item__remove {
      border:none;
      background:#f3f4f6;
      border-radius:999px;
      width:18px;
      height:18px;
      line-height:18px;
      text-align:center;
      font-size:12px;
      cursor:pointer;
    }

    .order-panel__footer {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:8px;
      font-weight:500;
    }

    .order-panel__total {
      font-size:14px;
    }

    .order-empty {
      font-size:12px;
      color:#9ca3af;
      padding:4px 0;
    }

    .costs-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,.35);
      backdrop-filter: blur(1px);
      z-index: 998;
      display: none;
    }

    /* –°–∞–º–æ –æ–∫–Ω–æ */
    .costs-panel {
      position: fixed;
      top: 60px;
      right: 20px;
      width: 340px;
      background: #fff;
      z-index: 999;
      border-radius: 14px;
      box-shadow: 0 18px 40px rgba(15,23,42,.18);
      padding: 20px;
      display: none;
    }

    .costs-panel__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .costs-panel__title {
      font-size: 14px;
      font-weight: 600;
    }

    .costs-panel__close {
      border: none;
      background: #e5e7eb;
      border-radius: 999px;
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 14px;
    }

    .costs-panel__grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
    }

    .costs-panel h3 {
      margin: 0 0 6px;
      font-size: 13px;
      font-weight: 600;
    }

    .costs-field {
      display: flex;
      flex-direction: column;
      gap: 3px;
      margin-bottom: 6px;
    }

    .costs-field label {
      font-size: 11px;
      color: #475569;
    }

    .costs-field input {
      padding: 4px 6px;
      font-size: 12px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
    }

    .costs-panel small {
      color: #94a3b8;
      font-size: 11px;
    }

    @media (max-width: 900px) {
      .costs-panel__grid {
        grid-template-columns: 1fr;
      }
    }

    .tab-content {
      display: none;
      padding: 16px;
    }

    .tab-content.active {
      display: block;
    }

    .tab-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .zippers-count,
    .zip-colors {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }

    .zip-option,
    .zip-color-option {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid #d9dee7;
      cursor: pointer;
      transition: 0.2s;
      text-align: center;
    }

    .zip-option.active,
    .zip-color-option.active {
      border-color: #4d8df5;
      background: #eaf1ff;
    }

    .tab-actions {
      display: flex;
      gap: 12px;
    }

    .btn-apply {
      flex: 1;
      background: #4d8df5;
      color: #fff;
      border-radius: 10px;
      padding: 10px;
    }

    .btn-clear {
      flex: 1;
      background: #f8fafc;
      color: #777;
      border-radius: 10px;
      padding: 10px;
      border: 1px solid #d9dee7;
    }


    /* –º–æ–¥–∞–ª–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞—Ä–º–∞–Ω–∞ */
    #tab-pocket {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,.35);
      display: none;
      z-index: 1000;
    }

    #tab-pocket .pocket-inner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border-radius: 16px;
      padding: 20px 24px;
      box-shadow: 0 18px 40px rgba(15,23,42,.25);
      min-width: 260px;
    }

    #pocketClose {
      position: absolute;
      top: 10px;
      right: 12px;
      border: none;
      background: #e5e7eb;
      border-radius: 999px;
      width: 24px;
      height: 24px;
      cursor: pointer;
    }


    /* –º–æ–¥–∞–ª–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –º–æ–ª–Ω–∏–∏ */
    #tab-zippers {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,.35);
      display: none;
      z-index: 1000;
      display: none;
    }

    #tab-zippers .zippers-inner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border-radius: 16px;
      padding: 20px 24px;
      box-shadow: 0 18px 40px rgba(15,23,42,.25);
      min-width: 260px;
    }

    #tab-zippers.active {
      display: block;
    }

    #zippersClose {
      position: absolute;
      top: 10px;
      right: 12px;
      border: none;
      background: #e5e7eb;
      border-radius: 999px;
      width: 24px;
      height: 24px;
      cursor: pointer;
    }

    /* –û–≤–µ—Ä–ª–µ–π –¥–ª—è –º–æ–¥–∞–ª–æ–∫ (–º–æ–ª–Ω–∏—è / –∫–∞—Ä–º–∞–Ω) */
    #tab-zippers{
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,.35);
      z-index: 1000;
      display: none;
    }

    /* –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∫–∞—Ä—Ç–æ—á–∫–∞ –∫–∞—Ä–º–∞–Ω–∞ */
    #tab-pocket .pocket-inner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #ffffff;
      border-radius: 16px;
      padding: 20px 24px;
      box-shadow: 0 18px 40px rgba(15,23,42,.25);
      min-width: 260px;
    }

    #pocketClose {
      position: absolute;
      top: 10px;
      right: 12px;
      border: none;
      background: #e5e7eb;
      border-radius: 999px;
      width: 24px;
      height: 24px;
      cursor: pointer;
    }
    .hardware-list {
      margin: 8px 0 10px;
      max-height: 210px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .hardware-item {
      display: flex;
      gap: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      background: #f9fbff;
      cursor: pointer;
      margin-bottom: 6px;
      transition: 0.15s ease;
    }

    .hardware-item__radio {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 2px solid #cbd5e1;
      margin-top: 4px;
      flex-shrink: 0;
      position: relative;
    }

    .hardware-item--active .hardware-item__radio {
      border-color: #2563eb;
    }

    .hardware-item--active .hardware-item__radio::after {
      content: "";
      position: absolute;
      inset: 3px;
      border-radius: inherit;
      background: #2563eb;
    }

    .hardware-item__body {
      flex: 1;
    }

    .hardware-item__top {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 2px;
    }

    .hardware-item__title {
      font-size: 13px;
      font-weight: 600;
    }

    .hardware-item__price {
      font-size: 13px;
      font-weight: 600;
      color: #1d4ed8;
    }

    .hardware-item__desc {
      font-size: 11px;
      color: var(--text-soft);
    }

    .hardware-item--active {
      border-color: #2563eb;
      background: #e0efff;
      box-shadow: 0 0 0 1px #bfdbfe;
    }

    .hardware-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      padding: 6px 0 4px;
      border-top: 1px solid #e5e7eb;
      margin-top: 4px;
    }

    .hardware-footer__label {
      color: var(--text-soft);
    }

    .hardware-footer__value {
      font-weight: 500;
    }

    /* –¥–æ–ø. –±–ª–æ–∫ */
    .hardware-advanced-toggle {
      margin-top: 4px;
      font-size: 11px;
      color: #2563eb;
      cursor: pointer;
      user-select: none;
    }

    .hardware-advanced {
      display: none;
      margin-top: 6px;
      padding-top: 6px;
      border-top: 1px dashed #e5e7eb;
    }

    .hardware-advanced.hardware-advanced--open {
      display: block;
    }
  </style>
</head>

<body>

<!-- –õ–û–ì–ò–ù -->
<div id="login-screen">
  <div id="login-box">
    <h1>–í—Ö–æ–¥ –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Ä–∞—Å—á—ë—Ç –º—è–≥–∫–∏—Ö –æ–∫–æ–Ω.</p>
    <div id="login-error"></div>
    <input id="login-user" type="text" placeholder="–õ–æ–≥–∏–Ω">
    <input id="login-pass" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
    <button onclick="checkLogin()">–í–æ–π—Ç–∏</button>
  </div>
</div>

<!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–°-->
<div id="app">
  <div class="soft-shell">
    <!-- –ú–û–õ–ù–ò–Ø -->
    <div class="tab-content" id="tab-zippers">
      <div class="zippers-inner">
        <button id="zippersClose">√ó</button>

        <h3 class="tab-title">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–ª–Ω–∏–π</h3>

        <div class="zippers-count">
          <div class="zip-option" data-count="0">
            <img src="img/zippers/zip0.svg">
          </div>
          <div class="zip-option" data-count="1">
            <img src="img/zippers/zip1.svg">
          </div>
          <div class="zip-option" data-count="2">
            <img src="img/zippers/zip2.svg">
          </div>
        </div>

        <h3 class="tab-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –º–æ–ª–Ω–∏–π</h3>

        <div class="zip-colors">
          <div class="zip-color-option" data-color="black">—á—ë—Ä–Ω—ã–π</div>
          <div class="zip-color-option" data-color="white">–±–µ–ª—ã–π</div>
        </div>

        <div class="tab-actions">
          <button class="btn-apply" id="applyZippers">–ü–†–ò–ú–ï–ù–ò–¢–¨</button>
          <button class="btn-clear" id="clearZippers">–û–ß–ò–°–¢–ò–¢–¨</button>
        </div>
      </div>
    </div>

    <!-- –ö–ê–†–ú–ê–ù –ü–û–î –£–¢–Ø–ñ–ï–õ–ò–¢–ï–õ–¨ -->
    <div class="tab-content" id="tab-pocket">
      <div class="pocket-inner">
        <button id="pocketClose">√ó</button>

        <h3 class="tab-title">–ö–∞—Ä–º–∞–Ω –ø–æ–¥ —É—Ç—è–∂–µ–ª–∏—Ç–µ–ª—å</h3>

        <p style="font-size:12px;color:#64748b;margin:4px 0 10px;">
          –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∫–∞—Ä–º–∞–Ω–∞ (—Å–º –ø–æ –≤—ã—Å–æ—Ç–µ).
        </p>

        <div class="zip-colors">
          <div class="zip-color-option pocket-option" data-size="3">3 —Å–º</div>
          <div class="zip-color-option pocket-option" data-size="4">4 —Å–º</div>
          <div class="zip-color-option pocket-option" data-size="5">5 —Å–º</div>
        </div>

        <div class="tab-actions" style="margin-top:16px;">
          <button class="btn-apply" id="applyPocket">–ü–†–ò–ú–ï–ù–ò–¢–¨</button>
          <button class="btn-clear" id="clearPocket">–û–ß–ò–°–¢–ò–¢–¨</button>
        </div>
      </div>
    </div>


    <!-- –ö–ê–†–ú–ê–ù –ü–û–î –£–¢–Ø–ñ–ï–õ–ò–¢–ï–õ–¨ -->
    <div class="tab-content" id="tab-pocket">
      <div class="pocket-inner">
        <button id="pocketClose">√ó</button>

        <h3 class="tab-title">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä–º–∞–Ω –ø–æ–¥ —É—Ç—è–∂–µ–ª–∏—Ç–µ–ª—å</h3>

        <div class="zip-colors">
          <div class="zip-color-option pocket-option" data-size="3">3</div>
          <div class="zip-color-option pocket-option" data-size="4">4</div>
          <div class="zip-color-option pocket-option" data-size="5">5</div>
        </div>

        <div class="tab-actions">
          <button class="btn-apply" id="applyPocket">–ü–†–ò–ú–ï–ù–ò–¢–¨</button>
          <button class="btn-clear" id="clearPocket">–û–ß–ò–°–¢–ò–¢–¨</button>
        </div>
      </div>
    </div>

    <!-- –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ -->
    <div class="soft-topbar">
      <!-- –§–æ–Ω –ø–æ–¥ –º–æ–¥–∞–ª–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ -->
      <div id="costs-backdrop" class="costs-backdrop"></div>

      <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–°—Ç–æ–∏–º–æ—Å—Ç—å" -->
      <div id="costs-panel" class="costs-panel">
        <div class="costs-panel__header">
          <div class="costs-panel__title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏</div>
          <button class="costs-panel__close" id="costs-close">√ó</button>
        </div>

        <div class="costs-panel__grid">
          <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã -->
          <div>
            <h3>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã, ‚ÇΩ/–º¬≤</h3>
            <div class="costs-field">
              <label>–ü–í–• 0.8 –º–º</label>
              <input id="price-pvc08" type="number" value="1400">
            </div>
            <div class="costs-field">
              <label>–ü–í–• 1.0 –º–º</label>
              <input id="price-pvc10" type="number" value="1600">
            </div>
            <div class="costs-field">
              <label>Softglass –ø—Ä–µ–º–∏—É–º</label>
              <input id="price-softglass" type="number" value="1900">
            </div>
          </div>

          <!-- –û–∫–∞–Ω—Ç–æ–≤–∫–∞ -->
          <div>
            <h3>–û–∫–∞–Ω—Ç–æ–≤–∫–∞</h3>
            <div class="costs-field">
              <label>–¶–µ–Ω–∞ –∑–∞ 1 –º</label>
              <input id="edgingPriceControl" type="number" value="80">
              <small>–ú–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –æ–∫–æ–Ω —Å—Ä–∞–∑—É</small>
            </div>
          </div>

          <!-- –†–∞–±–æ—Ç–∞ -->
          <div>
            <h3>–†–∞–±–æ—Ç–∞</h3>
            <div class="costs-field">
              <label>–†–∞–±–æ—Ç–∞ –∑–∞ 1 –º¬≤</label>
              <input id="laborPricePerM2" type="number" value="300">
              <small>–ü–∞–π–∫–∞, —Ä–∞—Å–∫—Ä–æ–π, –ø—Ä–æ–±–∏–≤–∫–∞ –∏ —Ç.–ø.</small>
            </div>
          </div>
        </div>
      </div>
      <div class="soft-topbar__left">
        <div class="soft-topbar__menu">
          <button class="soft-topbar__menu-btn" id="costs-toggle">–°—Ç–æ–∏–º–æ—Å—Ç—å</button>
          <button class="soft-topbar__menu-btn">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
          <button class="soft-topbar__menu-btn soft-topbar__menu-btn--primary">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
      </div>
      <div class="soft-topbar__right">
        <div class="soft-topbar__cart">
          <div class="soft-topbar__cart-icon">üõí</div>
          <div>
            <div style="font-size:11px;">–ò—Ç–æ–≥–æ –ø–æ –∑–∞–∫–∞–∑—É</div>
            <div style="font-size:13px;font-weight:600;" id="top-total">0 ‚ÇΩ</div>
          </div>
        </div>
        <div class="soft-topbar__user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
      </div>
    </div>

    <!-- –ü–ê–ù–ï–õ–¨ –ó–ê–ö–ê–ó–ê -->
    <div class="order-panel">
      <div class="order-panel__header">
        <div class="order-panel__title">–ó–∞–∫–∞–∑ –æ–∫–æ–Ω</div>
        <button class="btn-primary-small" onclick="copyOrderToClipboard()">
          –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑
        </button>
      </div>

      <div id="order-list" class="order-list"></div>

      <div class="order-panel__footer">
        <div>–ò—Ç–æ–≥–æ –ø–æ –∑–∞–∫–∞–∑—É:</div>
        <div id="order-total" class="order-panel__total">0 ‚ÇΩ</div>
      </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
    <div class="soft-main">

      <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ –î–û–ü. –ù–ê–°–¢–†–û–ï–ö -->
      <aside class="soft-sidebar">
        <div class="soft-sidebar__title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ<br>–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫–Ω–∞</div>
        <div class="soft-sidebar__items">
          <div class="soft-sidebar__item soft-sidebar__item--active" data-sidebar="zipper">
            <div class="soft-sidebar__item-icon"></div>
            <span>–ú–æ–ª–Ω–∏—è</span>
          </div>
          <div class="soft-sidebar__item" data-sidebar="skirt">
            <div class="soft-sidebar__item-icon"></div>
            <span>–Æ–±–∫–∞</span>
          </div>
          <div class="soft-sidebar__item" data-sidebar="pocket">
            <div class="soft-sidebar__item-icon"></div>
            <span>–ö–∞—Ä–º–∞–Ω</span>
          </div>
          <div class="soft-sidebar__item" data-sidebar="cutouts">
            <div class="soft-sidebar__item-icon"></div>
            <span>–í—ã—Ä–µ–∑</span>
          </div>
          <div class="soft-sidebar__item" data-sidebar="door">
            <div class="soft-sidebar__item-icon"></div>
            <span>–î–≤–µ—Ä—å</span>
          </div>
        </div>
      </aside>

      <!-- –ü–†–ê–í–ê–Ø –†–ê–ë–û–ß–ê–Ø –ó–û–ù–ê -->
      <div class="soft-work">

        <!-- –¶–ï–ù–¢–†: –û–ö–ù–û + –ë–ê–ó–û–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò -->
        <section class="soft-center">
          <div class="soft-center__header">
            <div class="soft-center__title">–û–ö–ù–û ‚Ññ1</div>
            <div class="soft-center__counter">01 / 01</div>
          </div>

          <div class="soft-drawing-wrapper">
            <div class="soft-drawing-top-scale">

            </div>
            <div class="soft-drawing-main">
              <svg id="preview" viewBox="0 0 520 440" style="width:100%;height:auto;">
              <!-- –†–∏—Å—É–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
            </svg>

            <!-- –°–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ (–º–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å, –≤–µ—Ä—Å—Ç–∫—É –Ω–µ –ª–æ–º–∞—é—Ç) -->
            <div style="display:none">
              <!-- –§–æ—Ä–º–∞ –æ–∫–Ω–∞ -->
              <select id="shape">
                <option value="rect" selected>–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫</option>
                <option value="trapezoid">–¢—Ä–∞–ø–µ—Ü–∏—è</option>
                <option value="arch">–ê—Ä–∫–∞</option>
                <option value="angledRight">–°–æ —Å—Ä–µ–∑–æ–º —Å–ø—Ä–∞–≤–∞</option>
              </select>

              <!-- –†–∞–∑–º–µ—Ä—ã, —Å–º -->
              <input id="width"  type="number" value="200">
              <input id="height" type="number" value="200">

              <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª -->
              <select id="material">
                <option value="pvc08" data-price="1400" selected>–ü–í–• 0.8 –º–º</option>
                <option value="pvc10" data-price="1600">–ü–í–• 1.0 –º–º</option>
                <option value="softglass" data-price="1900">Softglass –ø—Ä–µ–º–∏—É–º</option>
              </select>

              <!-- –û–∫–∞–Ω—Ç–æ–≤–∫–∞ –∏ —à–∞–≥ –∫—Ä–µ–ø–ª–µ–Ω–∏–π -->
              <input id="edgingPricePerM" type="number" value="80">
              <input id="grommetStep"     type="number" value="30">

              <!-- –Æ–±–∫–∞ (—Å–º) -->
              <input id="skirtHeightInput" type="number" value="0">
            </div>


            </div>
            <div class="soft-drawing-bottom-scale">
              
            </div>
          </div>
        </section>

        <!-- –ü–†–ê–í–´–ô –ú–ê–°–¢–ï–† –í–ö–õ–ê–î–û–ö -->
        <aside class="soft-right">
          <div class="soft-tabs">
            <div class="soft-tab soft-tab--active" data-tab="shape">
              <span class="icon"></span>–§–æ—Ä–º–∞
            </div>
            <div class="soft-tab" data-tab="material">
              <span class="icon"></span>–ú–∞—Ç–µ—Ä–∏–∞–ª
            </div>
            <div class="soft-tab" data-tab="edging">
              <span class="icon"></span>–û–∫–∞–Ω—Ç–æ–≤–∫–∞
            </div>
            <div class="soft-tab" data-tab="hardware">
              <span class="icon"></span>–§—É—Ä–Ω–∏—Ç—É—Ä–∞
            </div>
            <div class="soft-tab" data-tab="mount">
              <span class="icon"></span>–í–∞—Ä–∏–∞–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
            </div>
          </div>

          <div class="soft-tab-panel" data-panel="hardware">
            <div style="font-size:12px;color:var(--text-soft);margin-bottom:6px;">
              –í—ã–±–µ—Ä–∏—Ç–µ –∫—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–ª—è –æ–∫–Ω–∞.
            </div>

            <!-- –°–ü–ò–°–û–ö –ö–†–ï–ü–õ–ï–ù–ò–ô -->
            <div class="hardware-list">
              <div class="hardware-item hardware-item--active"
                  data-type="grommet10"
                  data-price="44">
                <div class="hardware-item__radio"></div>
                <div class="hardware-item__body">
                  <div class="hardware-item__top">
                    <div class="hardware-item__title">–õ—é–≤–µ—Ä—Å 10 –º–º</div>
                    <div class="hardware-item__price">44 ‚ÇΩ</div>
                  </div>
                  <div class="hardware-item__desc">
                    –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —É—Ç—è–∂–µ–ª–µ–Ω–∏—è –∏ –∫—Ä–µ–ø–ª–µ–Ω–∏—è –ø–ª—ë–Ω–∫–∏.
                    –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤, —Å—Ç–∞–≤–∏—Ç—Å—è –ø–æ –ø–µ—Ä–∏–º–µ—Ç—Ä—É.
                  </div>
                </div>
              </div>

              <div class="hardware-item"
                  data-type="bracket"
                  data-price="112">
                <div class="hardware-item__radio"></div>
                <div class="hardware-item__body">
                  <div class="hardware-item__top">
                    <div class="hardware-item__title">–°–∫–æ–±–∞ —Å —Ä—ã–º-–∫–æ–ª—å—Ü–æ–º</div>
                    <div class="hardware-item__price">112 ‚ÇΩ</div>
                  </div>
                  <div class="hardware-item__desc">
                    –£—Å–∏–ª–µ–Ω–Ω–æ–µ –∫—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–ª—è –≤–µ—Ç—Ä–µ–Ω—ã—Ö –∑–æ–Ω –∏ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ—ë–º–æ–≤.
                    –î–∞—ë—Ç –±–æ–ª–µ–µ –∂—ë—Å—Ç–∫—É—é —Ñ–∏–∫—Å–∞—Ü–∏—é.
                  </div>
                </div>
              </div>

              <div class="hardware-item"
                  data-type="metal-rotary"
                  data-price="143">
                <div class="hardware-item__radio"></div>
                <div class="hardware-item__body">
                  <div class="hardware-item__top">
                    <div class="hardware-item__title">–ü–æ–≤–æ—Ä–æ—Ç–Ω–∞—è –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∞—è</div>
                    <div class="hardware-item__price">143 ‚ÇΩ</div>
                  </div>
                  <div class="hardware-item__desc">
                    –£–¥–æ–±–Ω–∞ —Ç–∞–º, –≥–¥–µ –æ–∫–Ω–æ —á–∞—Å—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç.
                    –§–∏–∫—Å–∞—Ü–∏—è –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–º —Ñ–ª–∞–∂–∫–æ–º.
                  </div>
                </div>
              </div>

              <div class="hardware-item"
                  data-type="plastic-rotary"
                  data-price="95">
                <div class="hardware-item__radio"></div>
                <div class="hardware-item__body">
                  <div class="hardware-item__top">
                    <div class="hardware-item__title">–ü–æ–≤–æ—Ä–æ—Ç–Ω–∞—è –ø–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è</div>
                    <div class="hardware-item__price">95 ‚ÇΩ</div>
                  </div>
                  <div class="hardware-item__desc">
                    –õ—ë–≥–∫–∏–π –∏ –±—é–¥–∂–µ—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∫—Ä–µ–ø–ª–µ–Ω–∏—è
                    –¥–ª—è –≤–µ—Ä–∞–Ω–¥ –∏ –¥–∞—á–Ω—ã—Ö —Ç–µ—Ä—Ä–∞—Å.
                  </div>
                </div>
              </div>
            </div>

            <!-- –ù–∏–∑ –≤–∫–ª–∞–¥–∫–∏: –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –∫—Ä–µ–ø–ª–µ–Ω–∏—é -->
            <div class="hardware-footer">
              <div class="hardware-footer__left">
                <div class="hardware-footer__label">–¢–∏–ø –∫—Ä–µ–ø–ª–µ–Ω–∏—è</div>
                <div class="hardware-footer__value" id="hardware-selected-label">
                  –õ—é–≤–µ—Ä—Å 10 –º–º ¬∑ 44 ‚ÇΩ/—à—Ç
                </div>
              </div>
            </div>

            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å—Ç–∞—Ä—ã–π –±–ª–æ–∫) -->
            <div id="hardware-advanced-toggle" class="hardware-advanced-toggle">
              –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–º–æ–ª–Ω–∏—è, –∑–∞–ø–ª–∞—Ç–∫–∏, –≤—ã—Ä–µ–∑—ã)
            </div>

            <div class="hardware-advanced" id="hardware-advanced">
              <div style="font-size:12px;color:var(--text-soft);margin-top:6px;">
                –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —É–¥–æ–±—Å—Ç–≤–æ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å.
              </div>

              <div class="toggle-row">
                <div>–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –º–æ–ª–Ω–∏—è</div>
                <div class="toggle" id="toggle-zipper">
                  <div class="toggle__thumb"></div>
                </div>
              </div>

              <!-- –ö–∞—Ä–º–∞–Ω –ø–æ–¥ —É—Ç—è–∂–µ–ª–∏—Ç–µ–ª—å -->
              <div style="margin-top:10px;font-size:12px;">
                <div style="font-weight:600;margin-bottom:4px;">
                  –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä–º–∞–Ω –ø–æ–¥ —É—Ç—è–∂–µ–ª–∏—Ç–µ–ª—å
                </div>
                <div class="slider-pills" id="pocket-size-pills">
                  <div class="pill pill--active" data-pocket="0">–ù–µ—Ç</div>
                  <div class="pill" data-pocket="3">3</div>
                  <div class="pill" data-pocket="4">4</div>
                  <div class="pill" data-pocket="5">5</div>
                </div>
              </div>

              <div class="toggle-row">
                <div>–ó–∞–ø–ª–∞—Ç–∫–∏ —É—Å–∏–ª–µ–Ω–∏—è</div>
                <div class="slider-pills" id="patch-count-pills">
                  <div class="pill pill--active" data-patches="0">–ù–µ—Ç</div>
                  <div class="pill" data-patches="2">2</div>
                  <div class="pill" data-patches="4">4</div>
                </div>
              </div>

              <div class="toggle-row">
                <div>–í—ã—Ä–µ–∑—ã –ø–æ –±–æ–∫–∞–º</div>
                <div class="slider-pills" id="cutout-count-pills">
                  <div class="pill pill--active" data-cutouts="0">–ù–µ—Ç</div>
                  <div class="pill" data-cutouts="2">2</div>
                  <div class="pill" data-cutouts="3">3</div>
                </div>
              </div>

              <div style="margin-top:10px;font-size:11px;color:var(--text-soft);">
                –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (—Å–º) –æ—Ç –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è –∏ –≤–µ—Ä—Ö–∞ –æ–∫–Ω–∞:
              </div>

              <div class="settings-field" style="margin-top:6px;">
                <label>–ü–æ–∑–∏—Ü–∏–∏ –∑–∞–ø–ª–∞—Ç–æ–∫ (x,y; ...)</label>
                <input id="patchPositionsInput" type="text"
                      placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 30,40; 120,60"
                      style="font-size:11px;padding:4px 6px;">
              </div>

              <div class="settings-field" style="margin-top:4px;">
                <label>–ü–æ–∑–∏—Ü–∏–∏ –≤—ã—Ä–µ–∑–æ–≤ (x,y; ...)</label>
                <input id="cutoutPositionsInput" type="text"
                      placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 0,50; 0,110"
                      style="font-size:11px;padding:4px 6px;">
              </div>
            </div>
          </div>


          <!-- –°–≤–æ–¥–∫–∞ —Å–ø—Ä–∞–≤–∞ —Å–Ω–∏–∑—É -->
          <div class="summary-footer">
            <div class="summary-footer__price">
              <div style="font-size:11px;color:var(--text-soft);">–ü–ª–æ—â–∞–¥—å –æ–∫–Ω–∞</div>
              <div id="summary-area" style="font-size:12px;">0.00 –º¬≤</div>
              <div class="summary-footer__price-main" id="summary-total">0 ‚ÇΩ</div>
            </div>
            <div class="summary-footer__btns">
              <button class="btn-round" title="–°–±—Ä–æ—Å–∏—Ç—å –æ–∫–Ω–æ" onclick="resetSoftWindow()">‚ü≤</button>
              <button class="btn-add" onclick="addCurrentWindowToOrder()">
                <span class="icon"></span>
                <span>–î–æ–±–∞–≤–∏—Ç—å –æ–∫–Ω–æ</span>
              </button>
            </div>
          </div>
        </aside>
      </div>

      <!-- –ù–∏–∂–Ω—è—è –ø–æ–ª–æ—Å–∞ -->
      <div class="soft-bottom">
        <div class="soft-bottom__left">
          <span class="soft-bottom__badge" id="bottom-area-badge">0.00 –º¬≤</span>
          <span>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏</span>
        </div>
        <div>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º—è–≥–∫–∏—Ö –æ–∫–æ–Ω ¬∑ –¥–µ–º–æ-–≤–µ—Ä—Å–∏—è</div>
      </div>

    </div>
  </div>
</div>

<script>
  const ORDER_STORAGE_KEY = 'softglass_order_v1';
  const FRAME_CM = 5;

  const FRAME_THICKNESS = 14; // —Ç–æ–ª—â–∏–Ω–∞ —Ä–∞–º—ã –≤ px –≤ SVG
  // –°–ø–∏—Å–æ–∫ –æ–∫–æ–Ω –≤ –∑–∞–∫–∞–∑–µ
  let orderItems = [];
  let lastCalc = null; // —Å—é–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞—Å—á—ë—Ç –∏–∑ calcSoftWindow

  // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –æ–∫–Ω–∞
  const windowState = {
    hasZipper: false,        // –º–æ–ª–Ω–∏—è
    patchCount: 0,           // –∑–∞–ø–ª–∞—Ç–∫–∏
    sideCutouts: 0,          // –≤—ã—Ä–µ–∑—ã
    skirtHeight: 0,          // —é–±–∫–∞, —Å–º
    patchPositions: [],      // –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∑–∞–ø–ª–∞—Ç–æ–∫
    cutoutPositions: [],     // –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—ã—Ä–µ–∑–æ–≤
    hasPocket: false,        // –µ—Å—Ç—å –ª–∏ –∫–∞—Ä–º–∞–Ω –ø–æ–¥ —É—Ç—è–∂–µ–ª–∏—Ç–µ–ª—å
    pocketSize: null,         // —Ä–∞–∑–º–µ—Ä –∫–∞—Ä–º–∞–Ω–∞ (3 / 4 / 5)

    hardwareType: 'grommet10',
    hardwarePricePerPiece: 44
  };


  /* ============================================
    –£–¢–ò–õ–ò–¢–´
  ============================================ */
  function v(id) {
    return document.getElementById(id).value;
  }
  function num(id) {
    const el = document.getElementById(id);
    if (!el) return 0;
    return +el.value || 0;
  }
  function showBlock(id, show) {
    const el = document.getElementById(id);
    if (!el) return;
    el.style.display = show ? "block" : "none";
  }
  function updateSkirtFromInput() {
    const h = +document.getElementById("skirtHeightInput").value || 0;
    windowState.skirtHeight = h;
    if (typeof calcSoftWindow === "function") {
      calcSoftWindow();
    }
  }
  function setResult(html) {
    const block = document.getElementById('result-window');
    if (block) block.innerHTML = html;
  }


  /* SVG helper */
  function makeSVG(tag, attrs = {}) {
    const el = document.createElementNS("http://www.w3.org/2000/svg", tag);
    for (const k in attrs) el.setAttribute(k, attrs[k]);
    return el;
  }

  /* –°—Ç—Ä–µ–ª–æ—á–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ */
  function makeArrow(x, y, dir) {
    const s = 5;
    let d = "";
    if (dir === "left")  d = `M ${x + s} ${y - s} L ${x} ${y} L ${x + s} ${y + s}`;
    if (dir === "right") d = `M ${x - s} ${y - s} L ${x} ${y} L ${x - s} ${y + s}`;
    if (dir === "up")    d = `M ${x - s} ${y + s} L ${x} ${y} L ${x + s} ${y + s}`;
    if (dir === "down")  d = `M ${x - s} ${y - s} L ${x} ${y} L ${x + s} ${y - s}`;
    return makeSVG("path", {
      d, fill: "none", stroke: "#9ca3af",
      "stroke-width": 1.4, "stroke-linecap": "round"
    });
  }

  // "10,20; 30,40" -> [{xCm:10,yCm:20},{xCm:30,yCm:40}]
  function parsePositionsCm(str) {
    if (!str) return [];
    return str
      .split(";")
      .map(s => s.trim())
      .filter(Boolean)
      .map(pair => {
        const [xs, ys] = pair.split(",").map(p => p.trim());
        const xCm = Number(xs.replace(",", "."));
        const yCm = Number(ys.replace(",", "."));
        if (isNaN(xCm) || isNaN(yCm)) return null;
        return { xCm, yCm };
      })
      .filter(Boolean);
  }

  /* ============================================
    –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø ‚Äî –†–ê–°–ß–Å–¢ –û–ö–ù–ê
  ============================================ */
  function calcSoftWindow() {
    const shape = v("shape");
    const widthCm = num("width");
    const heightCm = num("height");

    const topDelta = shape === "trapezoid" ? num("topDelta") : 0;
    const archHeight = shape === "arch" ? num("archHeight") : 0;
    const flatTopHeight = shape === "angledRight" ? num("flatTopHeight") : 0;

    const edgingPricePerM = num("edgingPricePerM");
    const grommetStep = num("grommetStep") || 30;
    const laborPricePerM2 = num("laborPricePerM2") || 0;

    // –ú–∞—Ç–µ—Ä–∏–∞–ª
    const materialSel = document.getElementById("material");
    const materialPrice = +materialSel.selectedOptions[0].dataset.price;
    const materialName = materialSel.selectedOptions[0].innerText;

    if (!widthCm || !heightCm) {
      setResult("–í–≤–µ–¥–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã –æ–∫–Ω–∞");
      drawShape(shape, 0, 0, {});
      return;
    }

    const widthM = widthCm / 100;
    const heightM = heightCm / 100;

    let area = widthM * heightM;

    // –§–æ—Ä–º—ã
    if (shape === "trapezoid") {
      const topW = (widthCm - topDelta) / 100;
      area = ((widthM + topW) / 2) * heightM;
    }
    if (shape === "arch") {
      const rectH = heightM - archHeight / 100;
      const r = widthM / 2;
      area = (rectH > 0 ? rectH * widthM : 0) + (Math.PI * r * r) / 2;
    }
    if (shape === "angledRight") {
      const tri = Math.max(0, (heightCm - flatTopHeight) / 100);
      area = widthM * heightM - (tri * tri) / 2;
    }

    // –î–æ–ø—ã –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    const skirtHeight = windowState.skirtHeight || 0; // —Å–º

    // –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∑–∞–ø–ª–∞—Ç–æ–∫/–≤—ã—Ä–µ–∑–æ–≤ ‚Äî —Å—á–∏—Ç–∞–µ–º –ø–æ –Ω–∏–º, –∏–Ω–∞—á–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
    const manualPatchCount = (windowState.patchPositions && windowState.patchPositions.length) || 0;
    const manualCutoutCount = (windowState.cutoutPositions && windowState.cutoutPositions.length) || 0;

    const patchCount = manualPatchCount || windowState.patchCount || 0;
    const sideCutouts = manualCutoutCount || windowState.sideCutouts || 0;
    const hasZipper = !!windowState.hasZipper;

    const hasPocket = !!windowState.hasPocket;
    const pocketSize = windowState.pocketSize; // 3 / 4 / 5, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ


    // –Æ–±–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–ª–æ—â–∞–¥—å
    let skirtArea = 0;
    if (skirtHeight > 0) {
      skirtArea = (widthCm / 100) * (skirtHeight / 100);
      area += skirtArea;
    }

    // –û–∫–∞–Ω—Ç–æ–≤–∫–∞ (–ø–µ—Ä–∏–º–µ—Ç—Ä –ø–æ–∫–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π)
    const perimeterM = 2 * (widthM + heightM);
    const edgingCost = perimeterM * edgingPricePerM;

    // –ü–ª—ë–Ω–∫–∞
    const filmCost = area * materialPrice;

    // –†–∞–±–æ—Ç–∞ (–ø–∞–π–∫–∞, —Ä–∞—Å–∫—Ä–æ–π –∏ —Ç.–¥.)
    const laborCost = area * laborPricePerM2;

    // –õ—é–≤–µ—Ä—Å—ã
    const grommetsCount = Math.max(4, Math.ceil((2 * (widthCm + heightCm)) / grommetStep));

    const hardwarePricePerPiece = windowState.hardwarePricePerPiece || 0;
    const hardwareCost = grommetsCount * hardwarePricePerPiece;

    // –¶–µ–Ω—ã –¥–æ–ø–æ–≤
    const patchPrice = 80;       // –∑–∞–ø–ª–∞—Ç–∫–∞
    const cutoutPrice = 120;     // –≤—ã—Ä–µ–∑
    const zipperPrice = 350;     // –º–æ–ª–Ω–∏—è
    const skirtPricePerM = 250;  // —é–±–∫–∞ –∑–∞ –ø–æ–≥–æ–Ω–Ω—ã–π –º–µ—Ç—Ä —à–∏—Ä–∏–Ω—ã
    const pocketCost = 0;

    const skirtCost = skirtHeight > 0 ? widthM * skirtPricePerM : 0;
    const patchCost = patchCount * patchPrice;
    const cutoutCost = sideCutouts * cutoutPrice;
    const zipperCost = hasZipper ? zipperPrice : 0;

    const total = Math.round(
      filmCost +
      edgingCost +
      skirtCost +
      patchCost +
      cutoutCost +
      zipperCost +
      laborCost +
      pocketCost +
      hardwareCost
    );


    // –ü–æ–¥–ø–∏—Å–∏
    const topLabel = document.getElementById("top-width-label");
    const bottomLabel = document.getElementById("bottom-width-label");
    if (topLabel) topLabel.textContent = widthCm + " —Å–º";
    if (bottomLabel) bottomLabel.textContent = widthCm + " —Å–º";

    setResult(`
      <strong>–§–æ—Ä–º–∞:</strong> ${shapeName(shape)}<br>
      –ú–∞—Ç–µ—Ä–∏–∞–ª: ${materialName}<br>
      –®–∏—Ä–∏–Ω–∞: ${widthCm} —Å–º, –≤—ã—Å–æ—Ç–∞: ${heightCm} —Å–º<br>
      –ü–ª–æ—â–∞–¥—å: ${area.toFixed(2)} –º¬≤<br>
      –õ—é–≤–µ—Ä—Å–æ–≤ (–ø—Ä–∏–º–µ—Ä–Ω–æ): ${grommetsCount} —à—Ç.<br>
      –ü–ª—ë–Ω–∫–∞: ${filmCost.toFixed(0)} ‚ÇΩ<br>
      –û–∫–∞–Ω—Ç–æ–≤–∫–∞: ${edgingCost.toFixed(0)} ‚ÇΩ<br>
      –†–∞–±–æ—Ç–∞: ${laborCost.toFixed(0)} ‚ÇΩ<br>
      ${skirtHeight > 0 ? `–Æ–±–∫–∞ (${skirtHeight} —Å–º): ${skirtCost.toFixed(0)} ‚ÇΩ<br>` : ``}
      ${patchCount > 0 ? `–ó–∞–ø–ª–∞—Ç–∫–∏ (${patchCount} —à—Ç.): ${patchCost.toFixed(0)} ‚ÇΩ<br>` : ``}
      ${sideCutouts > 0 ? `–í—ã—Ä–µ–∑—ã (${sideCutouts} —à—Ç.): ${cutoutCost.toFixed(0)} ‚ÇΩ<br>` : ``}
      ${hasZipper ? `–ú–æ–ª–Ω–∏—è: ${zipperCost.toFixed(0)} ‚ÇΩ<br>` : ``}
      ${hasPocket ? `–ö–∞—Ä–º–∞–Ω –ø–æ–¥ —É—Ç—è–∂–µ–ª–∏—Ç–µ–ª—å (${pocketSize || ''}): –¥–æ–±–∞–≤–ª–µ–Ω<br>` : ``}
      ${hardwarePricePerPiece > 0 ? `–ö—Ä–µ–ø–ª–µ–Ω–∏–µ: ${grommetsCount} —à—Ç. √ó ${hardwarePricePerPiece.toFixed(0)} ‚ÇΩ = ${hardwareCost.toFixed(0)} ‚ÇΩ<br>` : ``}
      <strong>–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ</strong>
    `);

    document.getElementById("summary-total").textContent = total + " ‚ÇΩ";
    document.getElementById("summary-area").textContent = area.toFixed(2) + " –º¬≤";
    document.getElementById("bottom-area-badge").textContent = area.toFixed(2) + " –º¬≤";
    document.getElementById("top-total").textContent = total + " ‚ÇΩ";

    // –ü–µ—Ä–µ–¥–∞—ë–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–∞–ª—å—à–µ
    drawShape(shape, widthCm, heightCm, {
      topDelta,
      archHeight,
      flatTopHeight,
      grommetStep,
      skirtHeight,
      patchCount,
      sideCutouts,
      hasZipper,
      hasPocket,
      pocketSize,
      patchPositions: windowState.patchPositions || [],
      cutoutPositions: windowState.cutoutPositions || []
    });


      // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞—Å—á—ë—Ç –¥–ª—è "–î–æ–±–∞–≤–∏—Ç—å –≤ –∑–∞–∫–∞–∑"
    lastCalc = {
      shape,
      shapeName: shapeName(shape),
      widthCm,
      heightCm,
      area: +area.toFixed(2),
      filmCost: Math.round(filmCost),
      edgingCost: Math.round(edgingCost),
      skirtHeight,
      patchCount,
      sideCutouts,
      hasZipper,
      hasPocket,
      pocketSize,
      total,
      materialName
    };

  }

  function shapeName(s) {
    return {
      rect: "–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫",
      trapezoid: "–¢—Ä–∞–ø–µ—Ü–∏—è",
      arch: "–ê—Ä–∫–∞",
      angledRight: "–°–æ —Å—Ä–µ–∑–æ–º —Å–ø—Ä–∞–≤–∞"
    }[s] || s;
  }

  /* ============================================
    –û–¢–†–ò–°–û–í–ö–ê SVG
  ============================================ */
  // –û–¢–†–ò–°–û–í–ö–ê –û–°–ù–û–í–ù–û–ô –§–û–†–ú–´ –û–ö–ù–ê
  function drawShape(shape, widthCm, heightCm, opts = {}) {
    const svg = document.getElementById('preview');
    if (!svg) return;
    svg.innerHTML = '';

    if (!widthCm || !heightCm) return;

    const padding = 40;
    const maxW = 520 - padding * 2;
    const maxH = 440 - padding * 2;

    const fullHeightCm = heightCm + (opts.skirtHeight || 0);
    const scale = Math.min(
      maxW / widthCm,
      maxH / (fullHeightCm || 1)
    );

    const outerW = widthCm * scale;
    const outerH = heightCm * scale;
    const framePx = FRAME_CM * scale; // —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ 5 —Å–º –≤ –ø–∏–∫—Å–µ–ª—è—Ö
    const innerX = framePx;
    const innerY = framePx;
    const innerW = outerW - 2 * framePx;
    const innerH = outerH - 2 * framePx;
    const skirtPx = (opts.skirtHeight || 0) * scale;
    const grommetStepCm = opts.grommetStep || 30;
    const grommetStepPx = grommetStepCm * scale;

    
    // –≥—Ä–∞–¥–∏–µ–Ω—Ç —Å—Ç–µ–∫–ª–∞
    const defs = makeSVG('defs');
    const grad = makeSVG('linearGradient', {
      id: 'glassGrad',
      x1: '0%', y1: '0%',
      x2: '100%', y2: '100%'
    });
    grad.appendChild(makeSVG('stop', { offset: '0%',  'stop-color': '#e5f3ff' }));
    grad.appendChild(makeSVG('stop', { offset: '100%','stop-color': '#c0dcf5' }));
    defs.appendChild(grad);
    svg.appendChild(defs);

    const g = makeSVG('g', {
      transform: `translate(${padding}, ${padding})`
    });
    svg.appendChild(g);

    // ---------- –ü–†–Ø–ú–û–£–ì–û–õ–¨–ù–ò–ö (–∫–∞–∫ –Ω–∞ –º–∞–∫–µ—Ç–µ) ----------
    if (shape === 'rect') {
      // —Ç—ë–º–Ω—ã–π –∫–∞–Ω—Ç —Å –∑–∞–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–º–∏ —É–≥–ª–∞–º–∏
      const frameRect = makeSVG('rect', {
        x: 0,
        y: 0,
        width: outerW,
        height: outerH,
        fill: '#2a2f38'
      });
      g.appendChild(frameRect);

      // —Å—Ç–µ–∫–ª–æ –≤–Ω—É—Ç—Ä–∏
      const glassRect = makeSVG('rect', {
        x: innerX,
        y: innerY,
        width: innerW,
        height: innerH,
        fill: 'url(#glassGrad)'
      });
      g.appendChild(glassRect);

      // –ª—é–≤–µ—Ä—Å—ã –∏ —Å–∫–æ–±—ã: –ø–æ —Ü–µ–Ω—Ç—Ä—É –∫–∞–Ω—Ç–∞, 2.5 —Å–º –æ—Ç —É–≥–ª–æ–≤
      placeGrommetsRect(
        g,
        widthCm,
        heightCm,
        scale,
        FRAME_CM,     // —à–∏—Ä–∏–Ω–∞ –∫–∞–Ω—Ç–∞ –≤ —Å–º
        grommetStepCm // —à–∞–≥ –∫—Ä–µ–ø–ª–µ–Ω–∏–π (30 / 40 / 50)
      );

      // —é–±–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
      if (skirtPx > 0) {
        const skirt = makeSVG('rect', {
          x: 0,
          y: outerH,
          width: outerW,
          height: framePx,
          fill: '#2a2f38'
        });
        g.appendChild(skirt);
      }

      drawSizes(svg, widthCm, heightCm + (opts.skirtHeight || 0), scale, padding);
      drawExtras(g, outerW, outerH, opts, scale, framePx);
      return;
    }

    // ---------- –û–°–¢–ê–õ–¨–ù–´–ï –§–û–†–ú–´ (–∫–∞–∫ –±—ã–ª–∏, —Å –º–∞–ª–µ–Ω—å–∫–∏–º —Ç—é–Ω–∏–Ω–≥–æ–º) ----------

    let points = [];

    if (shape === 'trapezoid') {
      const topDelta = opts.topDelta || 0;
      const topW = (widthCm - topDelta) * scale;
      const offset = (outerW - topW) / 2;

      points = [
        { x: 0,          y: outerH },
        { x: outerW,     y: outerH },
        { x: outerW - offset, y: 0 },
        { x: offset,     y: 0 }
      ];
    } else if (shape === 'angledRight') {
      const flatTopPx = (opts.flatTopHeight || 0) * scale;
      const slopeStartX = outerW * 0.65;

      points = [
        { x: 0,           y: outerH },
        { x: 0,           y: 0 },
        { x: outerW,      y: 0 },
        { x: outerW,      y: flatTopPx },
        { x: slopeStartX, y: outerH }
      ];
    }

    if (shape === 'arch') {
      const archPx = Math.min((opts.archHeight || 0) * scale, outerH - 20);
      const rectH = outerH - archPx;
      const radius = outerW / 2;

      const path = makeSVG('path', {
        d: `
          M 0 ${outerH}
          L 0 ${rectH}
          A ${radius} ${radius} 0 0 1 ${outerW} ${rectH}
          L ${outerW} ${outerH}
          Z
        `,
        fill: 'url(#glassGrad)',
        stroke: '#2a2f38',
        'stroke-width': framePx,
        'stroke-linejoin': 'miter'
      });
      g.appendChild(path);

      placeGrommetsArch(g, outerW, outerH, rectH, grommetStepPx);

      if (skirtPx > 0) {
        const skirt = makeSVG('rect', {
          x: 0,
          y: outerH,
          width: outerW,
          height: framePx,
          fill: '#2a2f38'
        });
        g.appendChild(skirt);
      }

      drawSizes(svg, widthCm, heightCm + (opts.skirtHeight || 0), scale, padding);
      drawExtras(g, outerW, outerH, opts, scale, framePx);
      return;
    }

    // —Ç—Ä–∞–ø–µ—Ü–∏—è / —Å—Ä–µ–∑ —Å–ø—Ä–∞–≤–∞ ‚Äî —á–µ—Ä–µ–∑ path
    if (points.length) {
      const d =
        points.map((p, i) =>
          (i === 0 ? `M ${p.x} ${p.y}` : `L ${p.x} ${p.y}`)
        ).join(' ') + ' Z';

      const path = makeSVG('path', {
        d,
        fill: 'url(#glassGrad)',
        stroke: '#2a2f38',
        'stroke-width': framePx,
        'stroke-linejoin': 'miter'
      });
      g.appendChild(path);

      placeGrommetsPath(g, points, grommetStepPx);
    }

    if (skirtPx > 0) {
      const skirt = makeSVG('rect', {
        x: 0,
        y: outerH,
        width: outerW,
        height: framePx,
        fill: '#2a2f38'
      });
      g.appendChild(skirt);
    }

    drawSizes(svg, widthCm, heightCm + (opts.skirtHeight || 0), scale, padding);
    drawExtras(g, outerW, outerH, opts, scale, framePx);
  }

  // –õ–Æ–í–ï–†–°–´ –ü–û –ü–†–û–ò–ó–í–û–õ–¨–ù–û–ú–£ –ö–û–ù–¢–£–†–£
  function placeGrommetsPath(g, points, stepPx) {
    const r = 4;

    for (let i = 0; i < points.length; i++) {
      const p1 = points[i];
      const p2 = points[(i + 1) % points.length];

      const dx = p2.x - p1.x;
      const dy = p2.y - p1.y;
      const len = Math.hypot(dx, dy);

      const steps = Math.max(1, Math.floor(len / stepPx));
      for (let s = 0; s <= steps; s++) {
        const t = s / steps;
        const x = p1.x + dx * t;
        const y = p1.y + dy * t;

        g.appendChild(makeSVG('circle', {
          cx: x,
          cy: y,
          r,
          fill: '#ffffff',
          stroke: '#334155',
          'stroke-width': 1.3
        }));
      }
    }
  }


  // –õ–Æ–í–ï–†–°–´ –î–õ–Ø –ê–†–ö–ò
  function placeGrommetsArch(g, w, h, rectH, stepPx) {
    const r = 4;

    // –Ω–∏–∑
    for (let x = 0; x <= w; x += stepPx) {
      g.appendChild(makeSVG('circle', {
        cx: x,
        cy: h,
        r,
        fill: '#ffffff',
        stroke: '#334155',
        'stroke-width': 1.3
      }));
    }

    // –ª–µ–≤—ã–π –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π
    for (let y = h; y >= rectH; y -= stepPx) {
      g.appendChild(makeSVG('circle', {
        cx: 0,
        cy: y,
        r,
        fill: '#ffffff',
        stroke: '#334155',
        'stroke-width': 1.3
      }));
    }

    // –¥—É–≥–∞
    const radius = w / 2;
    const cx = w / 2;
    const cy = rectH;
    const arcLen = Math.PI * radius;
    const steps = Math.max(1, Math.floor(arcLen / stepPx));

    for (let i = 0; i <= steps; i++) {
      const angle = Math.PI - (Math.PI * i / steps); // –æ—Ç –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è –∫ –ø—Ä–∞–≤–æ–º—É
      const x = cx + radius * Math.cos(angle);
      const y = cy - radius * Math.sin(angle);

      g.appendChild(makeSVG('circle', {
        cx: x,
        cy: y,
        r,
        fill: '#ffffff',
        stroke: '#334155',
        'stroke-width': 1.3
      }));
    }

    // –ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π
    for (let y = rectH; y <= h; y += stepPx) {
      g.appendChild(makeSVG('circle', {
        cx: w,
        cy: y,
        r,
        fill: '#ffffff',
        stroke: '#334155',
        'stroke-width': 1.3
      }));
    }
  }

  function ensureGlassGradient(svg) {
    // —É–∂–µ –µ—Å—Ç—å ‚Äî –Ω–µ –¥—É–±–ª–∏—Ä—É–µ–º
    if (svg.querySelector('#glassGradSoft')) return;

    const defs = makeSVG('defs');
    const grad = makeSVG('linearGradient', {
      id: 'glassGradSoft',
      x1: '0%', y1: '0%',
      x2: '100%', y2: '100%'
    });

    grad.appendChild(makeSVG('stop', {
      offset: '0%',
      'stop-color': '#e8f6ff'
    }));
    grad.appendChild(makeSVG('stop', {
      offset: '50%',
      'stop-color': '#cfe8fb'
    }));
    grad.appendChild(makeSVG('stop', {
      offset: '100%',
      'stop-color': '#b3d4f3'
    }));

    defs.appendChild(grad);
    svg.appendChild(defs);
  }

  function drawGlassHighlight(g, w, h) {
    const highlight = makeSVG('path', {
      d: `
        M ${w * 0.05} ${h * 0.15}
        L ${w * 0.45} ${h * 0.05}
        L ${w * 0.6}  ${h * 0.35}
        L ${w * 0.2}  ${h * 0.45}
        Z
      `,
      fill: 'rgba(255,255,255,0.18)'
    });
    g.appendChild(highlight);
  }


  // –õ—é–≤–µ—Ä—Å—ã/—Å–∫–æ–±—ã –¥–ª—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞:
  function placeGrommetsRect(g, widthCm, heightCm, scale, frameCm, targetStepCm) {
    const offsetCm = 2.5;      // –æ—Ç—Å—Ç—É–ø –≤–¥–æ–ª—å —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç —É–≥–ª–æ–≤
    const centerInFrameCm = frameCm / 2; // –æ—Ç –∫—Ä–∞—è –¥–æ —Ü–µ–Ω—Ç—Ä–∞ –ø–æ —à–∏—Ä–∏–Ω–µ –∫–∞–Ω—Ç–∞
    const MIN_STEP = 20;
    const MAX_STEP = 40;

    function calcPositions(lengthCm) {
      const usable = lengthCm - 2 * offsetCm;
      if (usable <= 0) return [];

      let intervals = Math.max(1, Math.round(usable / targetStepCm));
      let stepCm = usable / intervals;

      if (stepCm < MIN_STEP) {
        intervals = Math.floor(usable / MIN_STEP) || 1;
        stepCm = usable / intervals;
      }
      if (stepCm > MAX_STEP) {
        intervals = Math.ceil(usable / MAX_STEP) || 1;
        stepCm = usable / intervals;
      }

      const pos = [];
      for (let i = 0; i <= intervals; i++) {
        pos.push(offsetCm + stepCm * i);
      }
      return pos;
    }

    const topXsCm  = calcPositions(widthCm);
    const sideYsCm = calcPositions(heightCm);

    const framePx = frameCm * scale;
    const topY    = centerInFrameCm * scale;
    const bottomY = heightCm * scale - centerInFrameCm * scale;
    const leftX   = centerInFrameCm * scale;
    const rightX  = widthCm * scale - centerInFrameCm * scale;

    function drawGlover(xPx, yPx) {
      const r = framePx * 0.3; // —Ä–∞–∑–º–µ—Ä –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —à–∏—Ä–∏–Ω–µ –∫–∞–Ω—Ç–∞
      g.appendChild(makeSVG('circle', {
        cx: xPx,
        cy: yPx,
        r,
        fill: '#ffffff',
        stroke: '#1f2937',
        'stroke-width': 1.5
      }));
    }

    function drawBracket(xPx, yPx) {
      const w = framePx * 0.9;
      const h = framePx * 1.1;

      const rect = makeSVG('rect', {
        x: xPx - w / 2,
        y: yPx - h / 2,
        width: w,
        height: h,
        rx: h * 0.3,
        ry: h * 0.3,
        fill: '#e5e7eb',
        stroke: '#4b5563',
        'stroke-width': 1
      });
      g.appendChild(rect);

      g.appendChild(makeSVG('circle', {
        cx: xPx,
        cy: yPx,
        r: w * 0.25,
        fill: '#ffffff',
        stroke: '#111827',
        'stroke-width': 1
      }));
    }

    // –≤–µ—Ä—Ö: –ª—é–≤–µ—Ä—Å—ã
    topXsCm.forEach(xCm => {
      const xPx = xCm * scale;
      drawGlover(xPx, topY);
    });

    // –Ω–∏–∑: —Ç–∞–∫–∏–µ –∂–µ –ª—é–≤–µ—Ä—Å—ã, –±–µ–∑ –∫—Ä–∞–π–Ω–∏—Ö, —á—Ç–æ–±—ã —É–≥–ª—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å
    topXsCm.forEach((xCm, i) => {
      if (i === 0 || i === topXsCm.length - 1) return;
      const xPx = xCm * scale;
      drawGlover(xPx, bottomY);
    });

    // –ª–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞: —Å–∫–æ–±—ã
    sideYsCm.forEach((yCm, i) => {
      if (i === 0 || i === sideYsCm.length - 1) return;
      const yPx = yCm * scale;
      drawBracket(leftX, yPx);
    });

    // –ø—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞: —Å–∫–æ–±—ã
    sideYsCm.forEach((yCm, i) => {
      if (i === 0 || i === sideYsCm.length - 1) return;
      const yPx = yCm * scale;
      drawBracket(rightX, yPx);
    });
  }
  // –î–æ–ø. –≥—Ä–∞—Ñ–∏–∫–∞: —é–±–∫–∞, –∑–∞–ø–ª–∞—Ç–∫–∏, –≤—ã—Ä–µ–∑—ã, –º–æ–ª–Ω–∏—è
  function drawExtras(g, w, h, opts, scale, frameThickness) {
    const skirtHeight = opts.skirtHeight || 0;
    const patchCount = opts.patchCount || 0;
    const sideCutouts = opts.sideCutouts || 0;
    const hasZipper = !!opts.hasZipper;
    const hasPocket = !!opts.hasPocket;
    const pocketSize = opts.pocketSize;

    const patchPositions = opts.patchPositions || [];
    const cutoutPositions = opts.cutoutPositions || [];

    const innerTop = frameThickness;
    const innerBottom = h - frameThickness;
    const innerLeft = frameThickness;
    const innerRight = w - frameThickness;

    // –Æ–±–∫–∞ (–≤–∏–∑—É–∞–ª—å–Ω–æ ‚Äì –∫–∞–∫ –µ—â—ë –æ–¥–Ω–∞ –ø–æ–ª–æ—Å–∞ —Ä–∞–º—ã —Å–Ω–∏–∑—É)
    if (skirtHeight > 0) {
      const skirt = makeSVG('rect', {
        x: 0,
        y: h,
        width: w,
        height: frameThickness,
        fill: '#2a2f38'
      });
      g.appendChild(skirt);
    }

    // –ó–ê–ü–õ–ê–¢–ö–ò
    if (patchPositions.length > 0) {
      patchPositions.forEach(pos => {
        const xPx = (pos.xCm || 0) * scale;
        const yPx = (pos.yCm || 0) * scale;
        const patch = makeSVG('rect', {
          x: xPx,
          y: yPx,
          width: 32,
          height: 20,
          fill: 'rgba(255,255,255,0.6)',
          stroke: '#94a3b8',
          'stroke-dasharray': '4 2'
        });
        g.appendChild(patch);
      });
    } else {
      for (let i = 0; i < patchCount; i++) {
        const x = innerLeft + 20 + i * 30;
        const y = innerTop + 25 + i * 15;
        const patch = makeSVG('rect', {
          x,
          y,
          width: 32,
          height: 20,
          fill: 'rgba(255,255,255,0.6)',
          stroke: '#94a3b8',
          'stroke-dasharray': '4 2'
        });
        g.appendChild(patch);
      }
    }

    // –í–´–†–ï–ó–´
    if (cutoutPositions.length > 0) {
      cutoutPositions.forEach(pos => {
        const xPx = (pos.xCm || 0) * scale;
        const yPx = (pos.yCm || 0) * scale;
        const cut = makeSVG('rect', {
          x: xPx,
          y: yPx,
          width: 12,
          height: 20,
          fill: '#ffffff',
          stroke: '#0f172a'
        });
        g.appendChild(cut);
      });
    } else {
      for (let i = 0; i < sideCutouts; i++) {
        const cut = makeSVG('rect', {
          x: innerLeft - 6,
          y: innerTop + 40 + i * 35,
          width: 12,
          height: 20,
          fill: '#ffffff',
          stroke: '#0f172a'
        });
        g.appendChild(cut);
      }
    }

    // –ú–û–õ–ù–ò–Ø
    if (hasZipper) {
      const zipX = innerRight - 8;
      const zip = makeSVG('line', {
        x1: zipX,
        y1: innerTop + 10,
        x2: zipX,
        y2: innerBottom - 10,
        stroke: '#0f172a',
        'stroke-width': 3
      });
      g.appendChild(zip);

      const head = makeSVG('rect', {
        x: zipX - 6,
        y: (innerTop + innerBottom) / 2 - 8,
        width: 12,
        height: 16,
        fill: '#ffffff',
        stroke: '#0f172a'
      });
      g.appendChild(head);
    }
  }

  function addCurrentWindowToOrder() {
    if (!lastCalc) return;

    const id = Date.now() + Math.random();

    const extras = [];
    if (lastCalc.skirtHeight > 0) extras.push(`—é–±–∫–∞ ${lastCalc.skirtHeight} —Å–º`);
    if (lastCalc.patchCount > 0)  extras.push(`–∑–∞–ø–ª–∞—Ç–∫–∏ ${lastCalc.patchCount} —à—Ç.`);
    if (lastCalc.sideCutouts > 0) extras.push(`–≤—ã—Ä–µ–∑—ã ${lastCalc.sideCutouts} —à—Ç.`);
    if (lastCalc.hasZipper)       extras.push(`–º–æ–ª–Ω–∏—è`);
    if (lastCalc.hasPocket)       extras.push(`–∫–∞—Ä–º–∞–Ω –ø–æ–¥ —É—Ç—è–∂–µ–ª–∏—Ç–µ–ª—å`);

    orderItems.push({
      id,
      title: `–û–∫–Ω–æ ${orderItems.length + 1}`,
      ...lastCalc,
      extrasText: extras.length ? extras.join(", ") : "–±–µ–∑ –¥–æ–ø–æ–≤"
    });

    renderOrderList();
  }

  function removeOrderItem(id) {
    orderItems = orderItems.filter(item => item.id !== id);
    renderOrderList();
  }

  function renderOrderList() {
    const listEl = document.getElementById("order-list");
    const totalEl = document.getElementById("order-total");
    if (!listEl || !totalEl) return;

    if (!orderItems.length) {
      listEl.innerHTML = `<div class="order-empty">–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –æ–∫–Ω–∞.</div>`;
      totalEl.textContent = "0 ‚ÇΩ";
      return;
    }

    let html = "";
    let sum = 0;

    orderItems.forEach(item => {
      sum += item.total;
      html += `
        <div class="order-item">
          <div class="order-item__main">
            <div class="order-item__title">${item.title}</div>
            <div class="order-item__meta">
              ${item.shapeName}, ${item.widthCm}√ó${item.heightCm} —Å–º
              ¬∑ ${item.area.toFixed(2)} –º¬≤
            </div>
            <div class="order-item__extras">
              ${item.materialName} ¬∑ ${item.extrasText}
            </div>
          </div>
          <div class="order-item__side">
            <div class="order-item__price">${item.total} ‚ÇΩ</div>
            <button class="order-item__remove" onclick="removeOrderItem(${item.id})">√ó</button>
          </div>
        </div>
      `;
    });

    listEl.innerHTML = html;
    totalEl.textContent = sum + " ‚ÇΩ";

    // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑ –≤ localStorage
    try {
      localStorage.setItem(ORDER_STORAGE_KEY, JSON.stringify(orderItems));
    } catch (e) {
      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–∫–∞–∑ –≤ localStorage', e);
    }

    // –æ–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—É –≤ –≤–µ—Ä—Ö–Ω–µ–π –≥–æ–ª—É–±–æ–π –ø–∞–Ω–µ–ª–∏
    const topTotalEl = document.getElementById('top-total');
    if (topTotalEl) {
      topTotalEl.textContent = sum + ' ‚ÇΩ';
    }
  }

  function loadOrderFromStorage() {
    try {
      const raw = localStorage.getItem(ORDER_STORAGE_KEY);
      if (!raw) return;
      const parsed = JSON.parse(raw);
      if (Array.isArray(parsed)) {
        orderItems = parsed;
        renderOrderList();
      }
    } catch (e) {
      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–∞–∫–∞–∑ –∏–∑ localStorage', e);
    }
  }

  function formatOrderForCopy() {
    if (!orderItems.length) {
      return '–ó–∞–∫–∞–∑ –ø—É—Å—Ç. –ù–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –æ–∫–Ω–∞.';
    }

    let lines = [];
    lines.push('–ó–∞–∫–∞–∑ –º—è–≥–∫–∏—Ö –æ–∫–æ–Ω:');
    lines.push('');

    let sum = 0;

    orderItems.forEach((item, index) => {
      sum += item.total;
      lines.push(`–û–∫–Ω–æ ${index + 1}:`);
      lines.push(`  –§–æ—Ä–º–∞: ${item.shapeName}`);
      lines.push(`  –†–∞–∑–º–µ—Ä—ã: ${item.widthCm} √ó ${item.heightCm} —Å–º`);
      lines.push(`  –ü–ª–æ—â–∞–¥—å: ${item.area.toFixed(2)} –º¬≤`);
      lines.push(`  –ú–∞—Ç–µ—Ä–∏–∞–ª: ${item.materialName}`);
      if (item.skirtHeight > 0) {
        lines.push(`  –Æ–±–∫–∞: ${item.skirtHeight} —Å–º`);
      }
      if (item.patchCount > 0) {
        lines.push(`  –ó–∞–ø–ª–∞—Ç–∫–∏: ${item.patchCount} —à—Ç.`);
      }
      if (item.sideCutouts > 0) {
        lines.push(`  –í—ã—Ä–µ–∑—ã: ${item.sideCutouts} —à—Ç.`);
      }
      if (item.hasZipper) {
        lines.push(`  –ú–æ–ª–Ω–∏—è: –µ—Å—Ç—å`);
      }
      lines.push(`  –°—Ç–æ–∏–º–æ—Å—Ç—å –æ–∫–Ω–∞: ${item.total} ‚ÇΩ`);
      lines.push('');
    });

    lines.push(`–ò–¢–û–ì–û –ø–æ –∑–∞–∫–∞–∑—É: ${sum} ‚ÇΩ`);

    return lines.join('\n');
  }

  async function copyOrderToClipboard() {
    const text = formatOrderForCopy();

    try {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        await navigator.clipboard.writeText(text);
        alert('–ó–∞–∫–∞–∑ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä. –ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —á–∞—Ç/–ø–∏—Å—å–º–æ.');
      } else {
        // —Å—Ç–∞—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã
        const temp = document.createElement('textarea');
        temp.value = text;
        document.body.appendChild(temp);
        temp.select();
        document.execCommand('copy');
        document.body.removeChild(temp);
        alert('–ó–∞–∫–∞–∑ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä. –ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —á–∞—Ç/–ø–∏—Å—å–º–æ.');
      }
    } catch (e) {
      console.error(e);
      alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é.');
    }
  }

  /* ============================================
    –†–ê–ó–ú–ï–†–´ –í–û–ö–†–£–ì SVG
  ============================================ */
  function drawSizes(svg, widthCm, heightCm, scale, pad, frameThickness = 0) {
    svg.appendChild((() => {
      const g = makeSVG("g");
      const w = widthCm * scale;
      const h = heightCm * scale;

      // –õ–∏–Ω–∏—è/—Å—Ç—Ä–µ–ª–∫–∏ —Å–≤–µ—Ä—Ö—É
      g.appendChild(makeSVG("line", {
        x1: pad,
        y1: 18,
        x2: pad + w,
        y2: 18,
        stroke: "#9ca3af",
        "stroke-width": 1.2
      }));
      g.appendChild(makeArrow(pad, 18, "left"));
      g.appendChild(makeArrow(pad + w, 18, "right"));

      // –ü–∏–ª–ª —Å —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ —à–∏—Ä–∏–Ω–µ (–∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω–µ "130")
      const pillW = 46;
      const pillH = 20;
      const pillX = pad + w / 2 - pillW / 2;
      const pillY = 22;

      const pillTop = makeSVG("rect", {
        x: pillX,
        y: pillY,
        width: pillW,
        height: pillH,
        rx: 10,
        ry: 10,
        fill: "#e0f2ff",
        stroke: "#38bdf8",
        "stroke-width": 1
      });
      g.appendChild(pillTop);

      const tTop = makeSVG("text", {
        x: pillX + pillW / 2,
        y: pillY + 14,
        "text-anchor": "middle",
        "font-size": 11,
        fill: "#0f172a"
      });
      tTop.textContent = widthCm;
      g.appendChild(tTop);

      // –õ–∏–Ω–∏—è/—Å—Ç—Ä–µ–ª–∫–∏ —Å–ª–µ–≤–∞
      g.appendChild(makeSVG("line", {
        x1: 18,
        y1: pad,
        x2: 18,
        y2: pad + h,
        stroke: "#9ca3af",
        "stroke-width": 1.2
      }));
      g.appendChild(makeArrow(18, pad, "up"));
      g.appendChild(makeArrow(18, pad + h, "down"));

      // –ü–∏–ª–ª —Å –≤—ã—Å–æ—Ç–æ–π ("115") —Å–ª–µ–≤–∞
      const pillLeftX = 8;
      const pillLeftY = pad + h / 2 - pillH / 2;

      const pillLeft = makeSVG("rect", {
        x: pillLeftX,
        y: pillLeftY,
        width: pillW,
        height: pillH,
        rx: 10,
        ry: 10,
        fill: "#e0f2ff",
        stroke: "#38bdf8",
        "stroke-width": 1
      });
      g.appendChild(pillLeft);

      const tLeft = makeSVG("text", {
        x: pillLeftX + pillW / 2,
        y: pillLeftY + 14,
        "text-anchor": "middle",
        "font-size": 11,
        fill: "#0f172a"
      });
      tLeft.textContent = heightCm;
      g.appendChild(tLeft);

      return g;
    })());
  }


  /* ============================================
    –°–ë–†–û–°
  ============================================ */
  function resetSoftWindow() {
    document.getElementById("shape").value = "rect";
    document.getElementById("width").value = 200;
    document.getElementById("height").value = 200;
    document.getElementById("edgingPricePerM").value = 80;
    document.getElementById("grommetStep").value = 30;

    showBlock("trapezoidControls", false);
    showBlock("archControls", false);
    showBlock("angledRightControls", false);

    calcSoftWindow();
  }

  /* ============================================
    –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
  ============================================ */
  document.addEventListener("DOMContentLoaded", () => {
    loadOrderFromStorage();
    calcSoftWindow();
  });
</script>

<script>
  /* ==============================
    –õ–û–ì–ò–ù –ß–ï–†–ï–ó /api/login
  ============================== */
  async function checkLogin() {
    const u = document.getElementById('login-user').value.trim();
    const p = document.getElementById('login-pass').value.trim();
    const err = document.getElementById('login-error');

    if (!u || !p) {
      err.textContent = '–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å';
      return;
    }

    err.textContent = '–ü—Ä–æ–≤–µ—Ä—è—é...';

    try {
      const resp = await fetch('/api/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ login: u, pass: p })
      });

      const data = await resp.json().catch(() => ({}));

      if (!resp.ok) {
        // —Å—é–¥–∞ –ø—Ä–∏–¥—É—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–∏–ø–∞ "–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω" –∏–ª–∏ "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–µ—Å—Å–∏–π"
        err.textContent = data.error || '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
        return;
      }

      // —É—Å–ø–µ—Ö
      err.textContent = '';
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('app').style.display = 'block';

      if (typeof calcSoftWindow === 'function') {
        calcSoftWindow();
      }
    } catch (e) {
      console.error(e);
      err.textContent = '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º';
    }
  }

  // –ª–æ–≥–∏–Ω –ø–æ Enter
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && document.getElementById('login-screen').style.display !== 'none') {
      checkLogin();
    }
  });


  /* ==============================
    –¢–ê–ë–´ –°–ü–†–ê–í–ê
  ============================== */
  (function initTabs() {
    const tabs = Array.from(document.querySelectorAll('.soft-tab'));
    const panels = Array.from(document.querySelectorAll('.soft-tab-panel'));

    if (!tabs.length) return;

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const name = tab.dataset.tab;
        tabs.forEach(t => t.classList.toggle('soft-tab--active', t === tab));
        panels.forEach(p => p.classList.toggle('soft-tab-panel--active', p.dataset.panel === name));
      });
    });
  })();


  /* ==============================
    –í–´–ë–û–† –§–û–†–ú–´ –ß–ï–†–ï–ó –ö–ê–†–¢–û–ß–ö–ò
  ============================== */
  (function initShapeCards() {
    const cards = Array.from(document.querySelectorAll('.shape-card'));
    const shapeSelect = document.getElementById('shape');

    if (!cards.length || !shapeSelect) return;

    cards.forEach(card => {
      card.addEventListener('click', () => {
        const shape = card.dataset.shape;

        // –≤–∏–∑—É–∞–ª—å–Ω–æ
        cards.forEach(c => c.classList.toggle('shape-card--active', c === card));

        // –≤ —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ–ª–µ–∫—Ç
        shapeSelect.value = shape;

        // –ø–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –¥–æ–ø. –ø–æ–ª—è
        showBlock('trapezoidControls', shape === 'trapezoid');
        showBlock('archControls', shape === 'arch');
        showBlock('angledRightControls', shape === 'angledRight');

        if (typeof calcSoftWindow === 'function') {
          calcSoftWindow();
        }
      });
    });
  })();


  /* ==============================
    –ú–ê–¢–ï–†–ò–ê–õ ‚Äî –ü–ò–õ–Æ–õ–ò
  ============================== */
  (function initMaterialPills() {
    const pills = Array.from(document.querySelectorAll('#material-pills .pill'));
    const select = document.getElementById('material');
    const priceLabel = document.getElementById('material-price-label');

    if (!pills.length || !select) return;

    function setMaterial(val) {
      select.value = val;
      const opt = select.selectedOptions[0];
      if (opt && priceLabel) {
        priceLabel.textContent = (opt.dataset.price || '0') + ' ‚ÇΩ/–º¬≤';
      }
      if (typeof calcSoftWindow === 'function') {
        calcSoftWindow();
      }
    }

    pills.forEach(p => {
      p.addEventListener('click', () => {
        const val = p.dataset.material;
        pills.forEach(x => x.classList.toggle('pill--active', x === p));
        setMaterial(val);
      });
    });

    // —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    const active = pills.find(p => p.classList.contains('pill--active'));
    if (active) setMaterial(active.dataset.material);
  })();


  /* ==============================
    –û–ö–ê–ù–¢–û–í–ö–ê ‚Äî –¶–í–ï–¢ –ò –¶–ï–ù–ê
    (—Ü–≤–µ—Ç –ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ –∫–∞–∫ –≤–∏–∑—É–∞–ª—å–Ω–∞—è –æ–ø—Ü–∏—è)
  ============================== */
  (function initEdgingPills() {
    const pricePills = Array.from(document.querySelectorAll('#edging-price-pills .pill'));
    const edgingInput = document.getElementById('edgingPricePerM');

    if (pricePills.length && edgingInput) {
      pricePills.forEach(p => {
        p.addEventListener('click', () => {
          pricePills.forEach(x => x.classList.toggle('pill--active', x === p));
          const price = +p.dataset.price || 0;
          edgingInput.value = price;
          if (typeof calcSoftWindow === 'function') {
            calcSoftWindow();
          }
        });
      });
    }

    const colorPills = Array.from(document.querySelectorAll('#edging-color-row .pill'));
    if (colorPills.length) {
      colorPills.forEach(p => {
        p.addEventListener('click', () => {
          colorPills.forEach(x => x.classList.toggle('pill--active', x === p));
          // –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ—Ç–æ–º –¥–æ–±–∞–≤–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ —Ü–≤–µ—Ç–∞ –Ω–∞ —Ü–µ–Ω—É
        });
      });
    }
  })();


  /* ==============================
    –§–£–†–ù–ò–¢–£–†–ê ‚Äî –¢–£–ú–ë–õ–ï–†–´ –ò –ü–ò–õ–Æ–õ–ò
    (—á–∞—Å—Ç–∏—á–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —à–∞–≥ –ª—é–≤–µ—Ä—Å–æ–≤)
  ============================== */
    (function initHardware() {
    // –ú–æ–ª–Ω–∏—è
    const toggleZipper = document.getElementById('toggle-zipper');
    if (toggleZipper) {
      toggleZipper.addEventListener('click', () => {
        toggleZipper.classList.toggle('toggle--on');
        windowState.hasZipper = toggleZipper.classList.contains('toggle--on');
        if (typeof calcSoftWindow === 'function') calcSoftWindow();
      });
    }

    // –ó–∞–ø–ª–∞—Ç–∫–∏ (–∫–æ–ª-–≤–æ)
    const patchPills = Array.from(document.querySelectorAll('#patch-count-pills .pill'));
    if (patchPills.length) {
      patchPills.forEach(p => {
        p.addEventListener('click', () => {
          patchPills.forEach(x => x.classList.toggle('pill--active', x === p));
          // –µ—Å–ª–∏ –µ—Å—Ç—å —Ä—É—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Äî –æ–Ω–∏ –≥–ª–∞–≤–Ω–µ–µ, –Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∂–µ –æ–±–Ω–æ–≤–∏–º
          windowState.patchCount = +p.dataset.patches || 0;
          if (typeof calcSoftWindow === 'function') calcSoftWindow();
        });
      });
    }

    // –í—ã—Ä–µ–∑—ã (–∫–æ–ª-–≤–æ)
    const cutoutPills = Array.from(document.querySelectorAll('#cutout-count-pills .pill'));
    if (cutoutPills.length) {
      cutoutPills.forEach(p => {
        p.addEventListener('click', () => {
          cutoutPills.forEach(x => x.classList.toggle('pill--active', x === p));
          windowState.sideCutouts = +p.dataset.cutouts || 0;
          if (typeof calcSoftWindow === 'function') calcSoftWindow();
        });
      });
    }

    // --- –†–£–ß–ù–´–ï –ö–û–û–†–î–ò–ù–ê–¢–´ ---

    const patchInput = document.getElementById('patchPositionsInput');
    if (patchInput) {
      patchInput.addEventListener('input', () => {
        const raw = patchInput.value.trim();
        windowState.patchPositions = parsePositionsCm(raw);
        if (typeof calcSoftWindow === 'function') calcSoftWindow();
      });
    }

        const cutoutInput = document.getElementById('cutoutPositionsInput');
    if (cutoutInput) {
      cutoutInput.addEventListener('input', () => {
        const raw = cutoutInput.value.trim();
        windowState.cutoutPositions = parsePositionsCm(raw);
        if (typeof calcSoftWindow === 'function') calcSoftWindow();
      });
    }

    // --- –ö–ê–†–ú–ê–ù –ü–û–î –£–¢–Ø–ñ–ï–õ–ò–¢–ï–õ–¨ ---
    const pocketPills = Array.from(document.querySelectorAll('#pocket-size-pills .pill'));
    if (pocketPills.length) {
      pocketPills.forEach(p => {
        p.addEventListener('click', () => {
          pocketPills.forEach(x => x.classList.toggle('pill--active', x === p));

          const val = +p.dataset.pocket || 0;
          if (val === 0) {
            // –ù–µ—Ç –∫–∞—Ä–º–∞–Ω–∞
            windowState.hasPocket = false;
            windowState.pocketSize = null;
          } else {
            windowState.hasPocket = true;
            windowState.pocketSize = val; // 3 / 4 / 5
          }

          if (typeof calcSoftWindow === 'function') calcSoftWindow();
        });
      });
    }
  })();

  /* ==============================
    –í–ê–†–ò–ê–ù–¢ –£–°–¢–ê–ù–û–í–ö–ò ‚Äî –®–ê–ì –ö–†–ï–ü–õ–ï–ù–ò–ô
  ============================== */
  (function initMount() {
    const stepPills = Array.from(document.querySelectorAll('#mount-step-pills .pill'));
    const grommetInput = document.getElementById('grommetStep');

    if (stepPills.length && grommetInput) {
      stepPills.forEach(p => {
        p.addEventListener('click', () => {
          stepPills.forEach(x => x.classList.toggle('pill--active', x === p));
          const step = +p.dataset.step || 30;
          grommetInput.value = step;
          if (typeof calcSoftWindow === 'function') {
            calcSoftWindow();
          }
        });
      });
    }

    // —Ç—É–º–±–ª–µ—Ä—ã "–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É / –ø–æ –±–æ–∫–∞–º" ‚Äî –ø–æ–∫–∞ –≤–∏–∑—É–∞–ª
    const tTop = document.getElementById('toggle-mount-top');
    const tSides = document.getElementById('toggle-mount-sides');

    [tTop, tSides].forEach(t => {
      if (!t) return;
      t.addEventListener('click', () => {
        t.classList.toggle('toggle--on');
      });
    });
  })();


  /* ==============================
    –õ–ï–í–ê–Ø –í–ï–†–¢–ò–ö–ê–õ–¨–ù–ê–Ø –ü–ê–ù–ï–õ–¨
  ============================== */
  function openZippersModal() {
    const m = document.getElementById('tab-zippers');
    if (m) m.classList.add('active');
  }

  function closeZippersModal() {
    const m = document.getElementById('tab-zippers');
    if (m) m.classList.remove('active');
  }

  (function initSidebar() {
    const items = Array.from(document.querySelectorAll('.soft-sidebar__item'));
    if (!items.length) return;

    function openTab(name) {
      const tab = document.querySelector(`.soft-tab[data-tab="${name}"]`);
      if (tab) tab.click();
    }

    items.forEach(item => {
      item.addEventListener('click', () => {
        items.forEach(x => x.classList.toggle('soft-sidebar__item--active', x === item));
        const type = item.dataset.sidebar;

        // –ú–æ–ª–Ω–∏—è
        if (type === 'zipper') {
          openTab('hardware');
          openZippersModal();
          
          const t = document.getElementById('toggle-zipper');
          if (t && !t.classList.contains('toggle--on')) {
            t.classList.add('toggle--on');
            windowState.hasZipper = true;
            if (typeof calcSoftWindow === 'function') calcSoftWindow();
          }
        }

        // –Æ–±–∫–∞
        if (type === 'skirt') {
          const input = document.getElementById('skirtHeightInput');
          if (input) {
            input.focus();
            input.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
        }

        // –í—ã—Ä–µ–∑
        if (type === 'cutouts') {
          openTab('hardware');
          const input = document.getElementById('cutoutPositionsInput');
          if (input) {
            input.focus();
            input.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
        }

        // –ö–∞—Ä–º–∞–Ω ‚Äî –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –∫–∏–¥–∞–µ–º –≤ "–§—É—Ä–Ω–∏—Ç—É—Ä–∞"
        if (type === 'pocket') {
          openPocketModal();
        }

        // –î–≤–µ—Ä—å ‚Äî –ª–æ–≥–∏—á–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ "–í–∞—Ä–∏–∞–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏"
        if (type === 'door') {
          openTab('mount');
        }
      });
    });
  })();

  (function initResultTabs() {
    const tabs = Array.from(document.querySelectorAll('.result-tab'));
    const windowView = document.getElementById('result-window');
    const orderView = document.getElementById('result-order');

    if (!tabs.length || !windowView || !orderView) return;

    function setView(name) {
      tabs.forEach(t => t.classList.toggle(
        'result-tab--active',
        t.dataset.view === name
      ));
      windowView.classList.toggle('result-view--active', name === 'window');
      orderView.classList.toggle('result-view--active', name === 'order');
    }

    tabs.forEach(tab => {
      tab.addEventListener('click', () => setView(tab.dataset.view));
    });

    setView('window');
  })();


  /* ==============================
    –ü–ê–ù–ï–õ–¨ "–°–¢–û–ò–ú–û–°–¢–¨" –°–í–ï–†–•–£
  ============================== */
  (function initCostsPanel() {
    const panel   = document.getElementById('costs-panel');
    const backdrop = document.getElementById('costs-backdrop');
    const btn     = document.getElementById('costs-toggle');
    const btnClose = document.getElementById('costs-close');
    const materialSelect = document.getElementById('material');

    if (!panel || !btn || !materialSelect || !backdrop) return;

    function openCosts() {
      panel.style.display = "block";
      backdrop.style.display = "block";
    }

    function closeCosts() {
      panel.style.display = "none";
      backdrop.style.display = "none";
    }

    btn.addEventListener('click', () => {
      const isOpen = panel.style.display === 'block';
      if (isOpen) {
        closeCosts();
      } else {
        openCosts();
      }
    });

    if (btnClose) btnClose.addEventListener('click', closeCosts);
    backdrop.addEventListener('click', closeCosts);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeCosts();
    });

    // –ø–æ–ª—è —Å —Ü–µ–Ω–∞–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
    const priceInputs = {
      pvc08:     document.getElementById('price-pvc08'),
      pvc10:     document.getElementById('price-pvc10'),
      softglass: document.getElementById('price-softglass')
    };

    const materialPriceLabel = document.getElementById('material-price-label');

    function syncMaterialPrices() {
      Array.from(materialSelect.options).forEach(opt => {
        const key = opt.value;
        const input = priceInputs[key];
        if (!input) return;
        const val = +input.value || 0;
        opt.dataset.price = val;
        if (opt.selected && materialPriceLabel) {
          materialPriceLabel.textContent = val + ' ‚ÇΩ/–º¬≤';
        }
      });

      if (typeof calcSoftWindow === 'function') {
        calcSoftWindow();
      }
    }

    Object.values(priceInputs).forEach(input => {
      if (!input) return;
      input.addEventListener('input', syncMaterialPrices);
    });

    // –æ–∫–∞–Ω—Ç–æ–≤–∫–∞: –ø–∞–Ω–µ–ª—å -> —Å–∫—Ä—ã—Ç—ã–π input edgingPricePerM
    const edgingHidden = document.getElementById('edgingPricePerM');
    const edgingControl = document.getElementById('edgingPriceControl');

    if (edgingHidden && edgingControl) {
      // —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–∞–Ω–µ–ª—å
      edgingControl.value = edgingHidden.value || edgingControl.value;

      edgingControl.addEventListener('input', () => {
        edgingHidden.value = edgingControl.value;
        if (typeof calcSoftWindow === 'function') {
          calcSoftWindow();
        }
      });
    }

    // –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ–¥–∏–Ω —Ä–∞–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Ü–µ–Ω—ã
    syncMaterialPrices();
  })();

  (function initZippersTab() {
    const modal = document.getElementById('tab-zippers');
    const closeBtn = document.getElementById('zippersClose');
    const countOptions = document.querySelectorAll('.zip-option');
    const colorOptions = document.querySelectorAll('.zip-color-option');

    let selectedCount = windowState.zippersCount || 0;
    let selectedColor = windowState.zippersColor || 'black';

    if (closeBtn) {
      closeBtn.addEventListener('click', closeZippersModal);
    }

    // –≤—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
    countOptions.forEach(el => {
      el.addEventListener('click', () => {
        countOptions.forEach(x => x.classList.remove('active'));
        el.classList.add('active');
        selectedCount = +el.dataset.count;
      });
    });

    // –≤—ã–±–æ—Ä —Ü–≤–µ—Ç–∞
    colorOptions.forEach(el => {
      el.addEventListener('click', () => {
        colorOptions.forEach(x => x.classList.remove('active'));
        el.classList.add('active');
        selectedColor = el.dataset.color;
      });
    });

    // –ü–†–ò–ú–ï–ù–ò–¢–¨
    document.getElementById('applyZippers').addEventListener('click', () => {
      windowState.zippersCount = selectedCount;
      windowState.zippersColor = selectedColor;
      calcSoftWindow();
      closeZippersModal();
    });

    // –û–ß–ò–°–¢–ò–¢–¨
    document.getElementById('clearZippers').addEventListener('click', () => {
      windowState.zippersCount = 0;
      windowState.zippersColor = 'black';

      countOptions.forEach(x => x.classList.remove('active'));
      colorOptions.forEach(x => x.classList.remove('active'));

      calcSoftWindow();
      closeZippersModal();
    });
  })();

  (function initPocketTab() {
    const modal    = document.getElementById('tab-pocket');
    if (!modal) return;

    const closeBtn = document.getElementById('pocketClose');
    const options  = document.querySelectorAll('.pocket-option');
    const applyBtn = document.getElementById('applyPocket');
    const clearBtn = document.getElementById('clearPocket');

    let selectedSize = windowState.pocketSize || 0;

    // –≤—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞
    options.forEach(el => {
      el.addEventListener('click', () => {
        options.forEach(x => x.classList.remove('active'));
        el.classList.add('active');
        selectedSize = +el.dataset.size || 0;
      });
    });

    // –ø—Ä–∏–º–µ–Ω–∏—Ç—å
    if (applyBtn) {
      applyBtn.addEventListener('click', () => {
        if (selectedSize > 0) {
          windowState.hasPocket  = true;
          windowState.pocketSize = selectedSize;
        } else {
          windowState.hasPocket  = false;
          windowState.pocketSize = null;
        }
        if (typeof calcSoftWindow === 'function') calcSoftWindow();
        closePocketModal();
      });
    }

    // –æ—á–∏—Å—Ç–∏—Ç—å
    if (clearBtn) {
      clearBtn.addEventListener('click', () => {
        windowState.hasPocket  = false;
        windowState.pocketSize = null;
        options.forEach(x => x.classList.remove('active'));
        if (typeof calcSoftWindow === 'function') calcSoftWindow();
        closePocketModal();
      });
    }

    // –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫—Ä–µ—Å—Ç–∏–∫—É
    if (closeBtn) {
      closeBtn.addEventListener('click', closePocketModal);
    }
  })();

  (function initHardwareFasteners() {
    const items = Array.from(document.querySelectorAll('.hardware-item'));
    const label = document.getElementById('hardware-selected-label');

    if (!items.length) return;

    function selectItem(item) {
      items.forEach(i => i.classList.remove('hardware-item--active'));
      item.classList.add('hardware-item--active');

      const type  = item.dataset.type || 'grommet10';
      const price = +item.dataset.price || 0;
      const titleEl = item.querySelector('.hardware-item__title');
      const title = titleEl ? titleEl.textContent.trim() : '–ö—Ä–µ–ø–ª–µ–Ω–∏–µ';

      windowState.hardwareType = type;
      windowState.hardwarePricePerPiece = price;

      if (label) {
        label.textContent = `${title} ¬∑ ${price} ‚ÇΩ/—à—Ç`;
      }

      if (typeof calcSoftWindow === 'function') {
        calcSoftWindow();
      }
    }

    items.forEach(item => {
      item.addEventListener('click', () => selectItem(item));
    });

    // —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî –ø–µ—Ä–≤—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –∏–ª–∏ –ø–µ—Ä–≤—ã–π –≤ —Å–ø–∏—Å–∫–µ
    const current = document.querySelector('.hardware-item--active') || items[0];
    if (current) selectItem(current);
  })();

  (function initHardwareAdvancedToggle() {
    const toggle = document.getElementById('hardware-advanced-toggle');
    const block  = document.getElementById('hardware-advanced');
    if (!toggle || !block) return;

    toggle.addEventListener('click', () => {
      block.classList.toggle('hardware-advanced--open');
    });
  })();

  function openPocketModal() {
    const m = document.getElementById('tab-pocket');
    if (m) m.style.display = 'block';
  }

  function closePocketModal() {
    const m = document.getElementById('tab-pocket');
    if (m) m.style.display = 'none';
  }
</script>
</body>
</html>
